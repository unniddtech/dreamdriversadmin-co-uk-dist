(window.webpackJsonp=window.webpackJsonp||[]).push([["vendors~app~281a44dd"],{5313:function(t,e,r){"use strict";r.d(e,"a",(function(){return f})),r.d(e,"b",(function(){return C})),r.d(e,"c",(function(){return u})),r.d(e,"d",(function(){return A})),r.d(e,"e",(function(){return R})),r.d(e,"f",(function(){return a})),r.d(e,"g",(function(){return l})),r.d(e,"h",(function(){return c}));var n=r("304a"),o=r("0ac0"),i=Object.create(null),a=function(t,e,r){this.ranges=r||[new l(t.min(e),t.max(e))],this.$anchor=t,this.$head=e},s={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};s.anchor.get=function(){return this.$anchor.pos},s.head.get=function(){return this.$head.pos},s.from.get=function(){return this.$from.pos},s.to.get=function(){return this.$to.pos},s.$from.get=function(){return this.ranges[0].$from},s.$to.get=function(){return this.ranges[0].$to},s.empty.get=function(){for(var t=this.ranges,e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0},a.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)},a.prototype.replace=function(t,e){void 0===e&&(e=n.j.empty);for(var r=e.content.lastChild,o=null,i=0;i<e.openEnd;i++)o=r,r=r.lastChild;for(var a=t.steps.length,s=this.ranges,l=0;l<s.length;l++){var c=s[l],p=c.$from,u=c.$to,h=t.mapping.slice(a);t.replaceRange(h.map(p.pos),h.map(u.pos),l?n.j.empty:e),0==l&&m(t,a,(r?r.isInline:o&&o.isTextblock)?-1:1)}},a.prototype.replaceWith=function(t,e){for(var r=t.steps.length,n=this.ranges,o=0;o<n.length;o++){var i=n[o],a=i.$from,s=i.$to,l=t.mapping.slice(r),c=l.map(a.pos),p=l.map(s.pos);o?t.deleteRange(c,p):(t.replaceRangeWith(c,p,e),m(t,r,e.isInline?-1:1))}},a.findFrom=function(t,e,r){var n=t.parent.inlineContent?new c(t):v(t.node(0),t.parent,t.pos,t.index(),e,r);if(n)return n;for(var o=t.depth-1;o>=0;o--){var i=e<0?v(t.node(0),t.node(o),t.before(o+1),t.index(o),e,r):v(t.node(0),t.node(o),t.after(o+1),t.index(o)+1,e,r);if(i)return i}},a.near=function(t,e){return void 0===e&&(e=1),this.findFrom(t,e)||this.findFrom(t,-e)||new f(t.node(0))},a.atStart=function(t){return v(t,t,0,0,1)||new f(t)},a.atEnd=function(t){return v(t,t,t.content.size,t.childCount,-1)||new f(t)},a.fromJSON=function(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");var r=i[e.type];if(!r)throw new RangeError("No selection type "+e.type+" defined");return r.fromJSON(t,e)},a.jsonID=function(t,e){if(t in i)throw new RangeError("Duplicate use of selection JSON ID "+t);return i[t]=e,e.prototype.jsonID=t,e},a.prototype.getBookmark=function(){return c.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(a.prototype,s),a.prototype.visible=!0;var l=function(t,e){this.$from=t,this.$to=e},c=function(t){function e(e,r){void 0===r&&(r=e),t.call(this,e,r)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={$cursor:{configurable:!0}};return r.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},e.prototype.map=function(r,n){var o=r.resolve(n.map(this.head));if(!o.parent.inlineContent)return t.near(o);var i=r.resolve(n.map(this.anchor));return new e(i.parent.inlineContent?i:o,o)},e.prototype.replace=function(e,r){if(void 0===r&&(r=n.j.empty),t.prototype.replace.call(this,e,r),r==n.j.empty){var o=this.$from.marksAcross(this.$to);o&&e.ensureMarks(o)}},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor&&t.head==this.head},e.prototype.getBookmark=function(){return new p(this.anchor,this.head)},e.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},e.fromJSON=function(t,r){if("number"!=typeof r.anchor||"number"!=typeof r.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new e(t.resolve(r.anchor),t.resolve(r.head))},e.create=function(t,e,r){void 0===r&&(r=e);var n=t.resolve(e);return new this(n,r==e?n:t.resolve(r))},e.between=function(r,n,o){var i=r.pos-n.pos;if(o&&!i||(o=i>=0?1:-1),!n.parent.inlineContent){var a=t.findFrom(n,o,!0)||t.findFrom(n,-o,!0);if(!a)return t.near(n,o);n=a.$head}return r.parent.inlineContent||(0==i||(r=(t.findFrom(r,-o,!0)||t.findFrom(r,o,!0)).$anchor).pos<n.pos!=i<0)&&(r=n),new e(r,n)},Object.defineProperties(e.prototype,r),e}(a);a.jsonID("text",c);var p=function(t,e){this.anchor=t,this.head=e};p.prototype.map=function(t){return new p(t.map(this.anchor),t.map(this.head))},p.prototype.resolve=function(t){return c.between(t.resolve(this.anchor),t.resolve(this.head))};var u=function(t){function e(e){var r=e.nodeAfter,n=e.node(0).resolve(e.pos+r.nodeSize);t.call(this,e,n),this.node=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(r,n){var o=n.mapResult(this.anchor),i=o.deleted,a=o.pos,s=r.resolve(a);return i?t.near(s):new e(s)},e.prototype.content=function(){return new n.j(n.c.from(this.node),0,0)},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor},e.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},e.prototype.getBookmark=function(){return new h(this.anchor)},e.fromJSON=function(t,r){if("number"!=typeof r.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new e(t.resolve(r.anchor))},e.create=function(t,e){return new this(t.resolve(e))},e.isSelectable=function(t){return!t.isText&&!1!==t.type.spec.selectable},e}(a);u.prototype.visible=!1,a.jsonID("node",u);var h=function(t){this.anchor=t};h.prototype.map=function(t){var e=t.mapResult(this.anchor),r=e.deleted,n=e.pos;return r?new p(n,n):new h(n)},h.prototype.resolve=function(t){var e=t.resolve(this.anchor),r=e.nodeAfter;return r&&u.isSelectable(r)?new u(e):a.near(e)};var f=function(t){function e(e){t.call(this,e.resolve(0),e.resolve(e.content.size))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.replace=function(e,r){if(void 0===r&&(r=n.j.empty),r==n.j.empty){e.delete(0,e.doc.content.size);var o=t.atStart(e.doc);o.eq(e.selection)||e.setSelection(o)}else t.prototype.replace.call(this,e,r)},e.prototype.toJSON=function(){return{type:"all"}},e.fromJSON=function(t){return new e(t)},e.prototype.map=function(t){return new e(t)},e.prototype.eq=function(t){return t instanceof e},e.prototype.getBookmark=function(){return d},e}(a);a.jsonID("all",f);var d={map:function(){return this},resolve:function(t){return new f(t)}};function v(t,e,r,n,o,i){if(e.inlineContent)return c.create(t,r);for(var a=n-(o>0?0:1);o>0?a<e.childCount:a>=0;a+=o){var s=e.child(a);if(s.isAtom){if(!i&&u.isSelectable(s))return u.create(t,r-(o<0?s.nodeSize:0))}else{var l=v(t,s,r+o,o<0?s.childCount:0,o,i);if(l)return l}r+=s.nodeSize*o}}function m(t,e,r){var n=t.steps.length-1;if(!(n<e)){var i,s=t.steps[n];if(s instanceof o.c||s instanceof o.b)t.mapping.maps[n].forEach((function(t,e,r,n){null==i&&(i=n)})),t.setSelection(a.near(t.doc.resolve(i),r))}}var g=function(t){function e(e){t.call(this,e.doc),this.time=Date.now(),this.curSelection=e.selection,this.curSelectionFor=0,this.storedMarks=e.storedMarks,this.updated=0,this.meta=Object.create(null)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return r.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},e.prototype.setSelection=function(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},r.selectionSet.get=function(){return(1&this.updated)>0},e.prototype.setStoredMarks=function(t){return this.storedMarks=t,this.updated|=2,this},e.prototype.ensureMarks=function(t){return n.d.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this},e.prototype.addStoredMark=function(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))},e.prototype.removeStoredMark=function(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))},r.storedMarksSet.get=function(){return(2&this.updated)>0},e.prototype.addStep=function(e,r){t.prototype.addStep.call(this,e,r),this.updated=-3&this.updated,this.storedMarks=null},e.prototype.setTime=function(t){return this.time=t,this},e.prototype.replaceSelection=function(t){return this.selection.replace(this,t),this},e.prototype.replaceSelectionWith=function(t,e){var r=this.selection;return!1!==e&&(t=t.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||n.d.none))),r.replaceWith(this,t),this},e.prototype.deleteSelection=function(){return this.selection.replace(this),this},e.prototype.insertText=function(t,e,r){void 0===r&&(r=e);var n=this.doc.type.schema;if(null==e)return t?this.replaceSelectionWith(n.text(t),!0):this.deleteSelection();if(!t)return this.deleteRange(e,r);var o=this.storedMarks;if(!o){var i=this.doc.resolve(e);o=r==e?i.marks():i.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(e,r,n.text(t,o)),this.selection.empty||this.setSelection(a.near(this.selection.$to)),this},e.prototype.setMeta=function(t,e){return this.meta["string"==typeof t?t:t.key]=e,this},e.prototype.getMeta=function(t){return this.meta["string"==typeof t?t:t.key]},r.isGeneric.get=function(){for(var t in this.meta)return!1;return!0},e.prototype.scrollIntoView=function(){return this.updated|=4,this},r.scrolledIntoView.get=function(){return(4&this.updated)>0},Object.defineProperties(e.prototype,r),e}(o.e);function w(t,e){return e&&t?t.bind(e):t}var y=function(t,e,r){this.name=t,this.init=w(e.init,r),this.apply=w(e.apply,r)},b=[new y("doc",{init:function(t){return t.doc||t.schema.topNodeType.createAndFill()},apply:function(t){return t.doc}}),new y("selection",{init:function(t,e){return t.selection||a.atStart(e.doc)},apply:function(t){return t.selection}}),new y("storedMarks",{init:function(t){return t.storedMarks||null},apply:function(t,e,r,n){return n.selection.$cursor?t.storedMarks:null}}),new y("scrollToSelection",{init:function(){return 0},apply:function(t,e){return t.scrolledIntoView?e+1:e}})],S=function(t,e){var r=this;this.schema=t,this.fields=b.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),e&&e.forEach((function(t){if(r.pluginsByKey[t.key])throw new RangeError("Adding different instances of a keyed plugin ("+t.key+")");r.plugins.push(t),r.pluginsByKey[t.key]=t,t.spec.state&&r.fields.push(new y(t.key,t.spec.state,t))}))},C=function(t){this.config=t},$={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};$.schema.get=function(){return this.config.schema},$.plugins.get=function(){return this.config.plugins},C.prototype.apply=function(t){return this.applyTransaction(t).state},C.prototype.filterTransaction=function(t,e){void 0===e&&(e=-1);for(var r=0;r<this.config.plugins.length;r++)if(r!=e){var n=this.config.plugins[r];if(n.spec.filterTransaction&&!n.spec.filterTransaction.call(n,t,this))return!1}return!0},C.prototype.applyTransaction=function(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};for(var e=[t],r=this.applyInner(t),n=null;;){for(var o=!1,i=0;i<this.config.plugins.length;i++){var a=this.config.plugins[i];if(a.spec.appendTransaction){var s=n?n[i].n:0,l=n?n[i].state:this,c=s<e.length&&a.spec.appendTransaction.call(a,s?e.slice(s):e,l,r);if(c&&r.filterTransaction(c,i)){if(c.setMeta("appendedTransaction",t),!n){n=[];for(var p=0;p<this.config.plugins.length;p++)n.push(p<i?{state:r,n:e.length}:{state:this,n:0})}e.push(c),r=r.applyInner(c),o=!0}n&&(n[i]={state:r,n:e.length})}}if(!o)return{state:r,transactions:e}}},C.prototype.applyInner=function(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var e=new C(this.config),r=this.config.fields,n=0;n<r.length;n++){var o=r[n];e[o.name]=o.apply(t,this[o.name],this,e)}for(var i=0;i<k.length;i++)k[i](this,t,e);return e},$.tr.get=function(){return new g(this)},C.create=function(t){for(var e=new S(t.doc?t.doc.type.schema:t.schema,t.plugins),r=new C(e),n=0;n<e.fields.length;n++)r[e.fields[n].name]=e.fields[n].init(t,r);return r},C.prototype.reconfigure=function(t){for(var e=new S(this.schema,t.plugins),r=e.fields,n=new C(e),o=0;o<r.length;o++){var i=r[o].name;n[i]=this.hasOwnProperty(i)?this[i]:r[o].init(t,n)}return n},C.prototype.toJSON=function(t){var e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map((function(t){return t.toJSON()}))),t&&"object"==typeof t)for(var r in t){if("doc"==r||"selection"==r)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var n=t[r],o=n.spec.state;o&&o.toJSON&&(e[r]=o.toJSON.call(n,this[n.key]))}return e},C.fromJSON=function(t,e,r){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");var o=new S(t.schema,t.plugins),i=new C(o);return o.fields.forEach((function(o){if("doc"==o.name)i.doc=n.f.fromJSON(t.schema,e.doc);else if("selection"==o.name)i.selection=a.fromJSON(i.doc,e.selection);else if("storedMarks"==o.name)e.storedMarks&&(i.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(r)for(var s in r){var l=r[s],c=l.spec.state;if(l.key==o.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(e,s))return void(i[o.name]=c.fromJSON.call(l,t,e[s],i))}i[o.name]=o.init(t,i)}})),i},C.addApplyListener=function(t){k.push(t)},C.removeApplyListener=function(t){var e=k.indexOf(t);e>-1&&k.splice(e,1)},Object.defineProperties(C.prototype,$);var k=[];var A=function(t){this.props={},t.props&&function t(e,r,n){for(var o in e){var i=e[o];i instanceof Function?i=i.bind(r):"handleDOMEvents"==o&&(i=t(i,r,{})),n[o]=i}return n}(t.props,this,this.props),this.spec=t,this.key=t.key?t.key.key:N("plugin")};A.prototype.getState=function(t){return t[this.key]};var M=Object.create(null);function N(t){return t in M?t+"$"+ ++M[t]:(M[t]=0,t+"$")}var R=function(t){void 0===t&&(t="key"),this.key=N(t)};R.prototype.get=function(t){return t.config.pluginsByKey[this.key]},R.prototype.getState=function(t){return t[this.key]}},"55be":function(t,e,r){"use strict";r.d(e,"a",(function(){return tt})),r.d(e,"b",(function(){return Z})),r.d(e,"c",(function(){return it})),r.d(e,"d",(function(){return ot})),r.d(e,"e",(function(){return Ct})),r.d(e,"f",(function(){return rt})),r.d(e,"g",(function(){return st})),r.d(e,"h",(function(){return wt})),r.d(e,"i",(function(){return U})),r.d(e,"j",(function(){return gt})),r.d(e,"k",(function(){return ct})),r.d(e,"l",(function(){return ut})),r.d(e,"m",(function(){return pt})),r.d(e,"n",(function(){return Rt})),r.d(e,"o",(function(){return w})),r.d(e,"p",(function(){return mt})),r.d(e,"q",(function(){return vt})),r.d(e,"r",(function(){return dt}));var n,o,i=r("5313"),a=r("304a"),s=r("7f06"),l=r("576a"),c=r("0ac0");if("undefined"!=typeof WeakMap){var p=new WeakMap;n=function(t){return p.get(t)},o=function(t,e){return p.set(t,e),e}}else{var u=[],h=0;n=function(t){for(var e=0;e<u.length;e+=2)if(u[e]==t)return u[e+1]},o=function(t,e){return 10==h&&(h=0),u[h++]=t,u[h++]=e}}var f=function(t,e,r,n){this.left=t,this.top=e,this.right=r,this.bottom=n},d=function(t,e,r,n){this.width=t,this.height=e,this.map=r,this.problems=n};function v(t){if(t.colwidth)return t.colwidth.slice();for(var e=[],r=0;r<t.colspan;r++)e.push(0);return e}function m(t,e){var r=t.getAttribute("data-colwidth"),n=r&&/^\d+(,\d+)*$/.test(r)?r.split(",").map((function(t){return Number(t)})):null,o=Number(t.getAttribute("colspan")||1),i={colspan:o,rowspan:Number(t.getAttribute("rowspan")||1),colwidth:n&&n.length==o?n:null};for(var a in e){var s=e[a].getFromDOM,l=s&&s(t);null!=l&&(i[a]=l)}return i}function g(t,e){var r={};for(var n in 1!=t.attrs.colspan&&(r.colspan=t.attrs.colspan),1!=t.attrs.rowspan&&(r.rowspan=t.attrs.rowspan),t.attrs.colwidth&&(r["data-colwidth"]=t.attrs.colwidth.join(",")),e){var o=e[n].setDOMAttr;o&&o(t.attrs[n],r)}return r}function w(t){var e=t.cellAttributes||{},r={colspan:{default:1},rowspan:{default:1},colwidth:{default:null}};for(var n in e)r[n]={default:e[n].default};return{table:{content:"table_row+",tableRole:"table",isolating:!0,group:t.tableGroup,parseDOM:[{tag:"table"}],toDOM:function(){return["table",["tbody",0]]}},table_row:{content:"(table_cell | table_header)*",tableRole:"row",parseDOM:[{tag:"tr"}],toDOM:function(){return["tr",0]}},table_cell:{content:t.cellContent,attrs:r,tableRole:"cell",isolating:!0,parseDOM:[{tag:"td",getAttrs:function(t){return m(t,e)}}],toDOM:function(t){return["td",g(t,e),0]}},table_header:{content:t.cellContent,attrs:r,tableRole:"header_cell",isolating:!0,parseDOM:[{tag:"th",getAttrs:function(t){return m(t,e)}}],toDOM:function(t){return["th",g(t,e),0]}}}}function y(t){var e=t.cached.tableNodeTypes;if(!e)for(var r in e=t.cached.tableNodeTypes={},t.nodes){var n=t.nodes[r],o=n.spec.tableRole;o&&(e[o]=n)}return e}d.prototype.findCell=function(t){for(var e=0;e<this.map.length;e++){var r=this.map[e];if(r==t){for(var n=e%this.width,o=e/this.width|0,i=n+1,a=o+1,s=1;i<this.width&&this.map[e+s]==r;s++)i++;for(var l=1;a<this.height&&this.map[e+this.width*l]==r;l++)a++;return new f(n,o,i,a)}}throw new RangeError("No cell with offset "+t+" found")},d.prototype.colCount=function(t){for(var e=0;e<this.map.length;e++)if(this.map[e]==t)return e%this.width;throw new RangeError("No cell with offset "+t+" found")},d.prototype.nextCell=function(t,e,r){var n=this.findCell(t),o=n.left,i=n.right,a=n.top,s=n.bottom;return"horiz"==e?(r<0?0==o:i==this.width)?null:this.map[a*this.width+(r<0?o-1:i)]:(r<0?0==a:s==this.height)?null:this.map[o+this.width*(r<0?a-1:s)]},d.prototype.rectBetween=function(t,e){var r=this.findCell(t),n=r.left,o=r.right,i=r.top,a=r.bottom,s=this.findCell(e),l=s.left,c=s.right,p=s.top,u=s.bottom;return new f(Math.min(n,l),Math.min(i,p),Math.max(o,c),Math.max(a,u))},d.prototype.cellsInRect=function(t){for(var e=[],r={},n=t.top;n<t.bottom;n++)for(var o=t.left;o<t.right;o++){var i=n*this.width+o,a=this.map[i];r[a]||(r[a]=!0,o==t.left&&o&&this.map[i-1]==a||n==t.top&&n&&this.map[i-this.width]==a||e.push(a))}return e},d.prototype.positionAt=function(t,e,r){for(var n=0,o=0;;n++){var i=o+r.child(n).nodeSize;if(n==t){for(var a=e+t*this.width,s=(t+1)*this.width;a<s&&this.map[a]<o;)a++;return a==s?i-1:this.map[a]}o=i}},d.get=function(t){return n(t)||o(t,function(t){if("table"!=t.type.spec.tableRole)throw new RangeError("Not a table node: "+t.type.name);for(var e=function(t){for(var e=-1,r=!1,n=0;n<t.childCount;n++){var o=t.child(n),i=0;if(r)for(var a=0;a<n;a++)for(var s=t.child(a),l=0;l<s.childCount;l++){var c=s.child(l);a+c.attrs.rowspan>n&&(i+=c.attrs.colspan)}for(var p=0;p<o.childCount;p++){var u=o.child(p);i+=u.attrs.colspan,u.attrs.rowspan>1&&(r=!0)}-1==e?e=i:e!=i&&(e=Math.max(e,i))}return e}(t),r=t.childCount,n=[],o=0,i=null,a=[],s=0,l=e*r;s<l;s++)n[s]=0;for(var c=0,p=0;c<r;c++){var u=t.child(c);p++;for(var h=0;;h++){for(;o<n.length&&0!=n[o];)o++;if(h==u.childCount)break;for(var f=u.child(h),m=f.attrs,g=m.colspan,w=m.rowspan,y=m.colwidth,b=0;b<w;b++){if(b+c>=r){(i||(i=[])).push({type:"overlong_rowspan",pos:p,n:w-b});break}for(var S=o+b*e,C=0;C<g;C++){0==n[S+C]?n[S+C]=p:(i||(i=[])).push({type:"collision",row:c,pos:p,n:g-C});var $=y&&y[C];if($){var k=(S+C)%e*2,A=a[k];null==A||A!=$&&1==a[k+1]?(a[k]=$,a[k+1]=1):A==$&&a[k+1]++}}}o+=g,p+=f.nodeSize}for(var M=(c+1)*e,N=0;o<M;)0==n[o++]&&N++;N&&(i||(i=[])).push({type:"missing",row:c,n:N}),p++}for(var R=new d(e,r,n,i),O=!1,z=0;!O&&z<a.length;z+=2)null!=a[z]&&a[z+1]<r&&(O=!0);O&&function(t,e,r){t.problems||(t.problems=[]);for(var n=0,o={};n<t.map.length;n++){var i=t.map[n];if(!o[i]){o[i]=!0;for(var a=r.nodeAt(i),s=null,l=0;l<a.attrs.colspan;l++){var c=(n+l)%t.width,p=e[2*c];null==p||a.attrs.colwidth&&a.attrs.colwidth[l]==p||((s||(s=v(a.attrs)))[l]=p)}s&&t.problems.unshift({type:"colwidth mismatch",pos:i,colwidth:s})}}}(R,a,t);return R}(t))};var b=new i.e("selectingCells");function S(t){for(var e=t.depth-1;e>0;e--)if("row"==t.node(e).type.spec.tableRole)return t.node(0).resolve(t.before(e+1));return null}function C(t){for(var e=t.selection.$head,r=e.depth;r>0;r--)if("row"==e.node(r).type.spec.tableRole)return!0;return!1}function $(t){var e=t.selection;return e.$anchorCell?e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell:e.node&&"cell"==e.node.type.spec.tableRole?e.$anchor:S(e.$head)||function(t){for(var e=t.nodeAfter,r=t.pos;e;e=e.firstChild,r++){var n=e.type.spec.tableRole;if("cell"==n||"header_cell"==n)return t.doc.resolve(r)}for(var o=t.nodeBefore,i=t.pos;o;o=o.lastChild,i--){var a=o.type.spec.tableRole;if("cell"==a||"header_cell"==a)return t.doc.resolve(i-o.nodeSize)}}(e.$head)}function k(t){return"row"==t.parent.type.spec.tableRole&&t.nodeAfter}function A(t,e){return t.depth==e.depth&&t.pos>=e.start(-1)&&t.pos<=e.end(-1)}function M(t,e,r){var n=t.start(-1),o=d.get(t.node(-1)).nextCell(t.pos-n,e,r);return null==o?null:t.node(0).resolve(n+o)}function N(t,e,r){var n={};for(var o in t)n[o]=t[o];return n[e]=r,n}function R(t,e,r){void 0===r&&(r=1);var n=N(t,"colspan",t.colspan-r);return n.colwidth&&(n.colwidth=n.colwidth.slice(),n.colwidth.splice(e,r),n.colwidth.some((function(t){return t>0}))||(n.colwidth=null)),n}function O(t,e,r){void 0===r&&(r=1);var n=N(t,"colspan",t.colspan+r);if(n.colwidth){n.colwidth=n.colwidth.slice();for(var o=0;o<r;o++)n.colwidth.splice(e,0,0)}return n}var z=function(t){function e(e,r){void 0===r&&(r=e);var n=e.node(-1),o=d.get(n),a=e.start(-1),s=o.rectBetween(e.pos-a,r.pos-a),l=e.node(0),c=o.cellsInRect(s).filter((function(t){return t!=r.pos-a}));c.unshift(r.pos-a);var p=c.map((function(t){var e=n.nodeAt(t),r=t+a+1;return new i.g(l.resolve(r),l.resolve(r+e.content.size))}));t.call(this,p[0].$from,p[0].$to,p),this.$anchorCell=e,this.$headCell=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(t,r){var n=t.resolve(r.map(this.$anchorCell.pos)),o=t.resolve(r.map(this.$headCell.pos));if(k(n)&&k(o)&&A(n,o)){var a=this.$anchorCell.node(-1)!=n.node(-1);return a&&this.isRowSelection()?e.rowSelection(n,o):a&&this.isColSelection()?e.colSelection(n,o):new e(n,o)}return i.h.between(n,o)},e.prototype.content=function(){for(var t=this.$anchorCell.node(-1),e=d.get(t),r=this.$anchorCell.start(-1),n=e.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r),o={},i=[],s=n.top;s<n.bottom;s++){for(var l=[],c=s*e.width+n.left,p=n.left;p<n.right;p++,c++){var u=e.map[c];if(!o[u]){o[u]=!0;var h=e.findCell(u),f=t.nodeAt(u),v=n.left-h.left,m=h.right-n.right;if(v>0||m>0){var g=f.attrs;v>0&&(g=R(g,0,v)),m>0&&(g=R(g,g.colspan-m,m)),f=h.left<n.left?f.type.createAndFill(g):f.type.create(g,f.content)}if(h.top<n.top||h.bottom>n.bottom){var w=N(f.attrs,"rowspan",Math.min(h.bottom,n.bottom)-Math.max(h.top,n.top));f=h.top<n.top?f.type.createAndFill(w):f.type.create(w,f.content)}l.push(f)}}i.push(t.child(s).copy(a.c.from(l)))}var y=this.isColSelection()&&this.isRowSelection()?t:i;return new a.j(a.c.from(y),1,1)},e.prototype.replace=function(e,r){void 0===r&&(r=a.j.empty);for(var n=e.steps.length,o=this.ranges,i=0;i<o.length;i++){var s=o[i],l=s.$from,c=s.$to,p=e.mapping.slice(n);e.replace(p.map(l.pos),p.map(c.pos),i?a.j.empty:r)}var u=t.findFrom(e.doc.resolve(e.mapping.slice(n).map(this.to)),-1);u&&e.setSelection(u)},e.prototype.replaceWith=function(t,e){this.replace(t,new a.j(a.c.from(e),0,0))},e.prototype.forEachCell=function(t){for(var e=this.$anchorCell.node(-1),r=d.get(e),n=this.$anchorCell.start(-1),o=r.cellsInRect(r.rectBetween(this.$anchorCell.pos-n,this.$headCell.pos-n)),i=0;i<o.length;i++)t(e.nodeAt(o[i]),n+o[i])},e.prototype.isColSelection=function(){var t=this.$anchorCell.index(-1),e=this.$headCell.index(-1);if(Math.min(t,e)>0)return!1;var r=t+this.$anchorCell.nodeAfter.attrs.rowspan,n=e+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(r,n)==this.$headCell.node(-1).childCount},e.colSelection=function(t,r){void 0===r&&(r=t);var n=d.get(t.node(-1)),o=t.start(-1),i=n.findCell(t.pos-o),a=n.findCell(r.pos-o),s=t.node(0);return i.top<=a.top?(i.top>0&&(t=s.resolve(o+n.map[i.left])),a.bottom<n.height&&(r=s.resolve(o+n.map[n.width*(n.height-1)+a.right-1]))):(a.top>0&&(r=s.resolve(o+n.map[a.left])),i.bottom<n.height&&(t=s.resolve(o+n.map[n.width*(n.height-1)+i.right-1]))),new e(t,r)},e.prototype.isRowSelection=function(){var t=d.get(this.$anchorCell.node(-1)),e=this.$anchorCell.start(-1),r=t.colCount(this.$anchorCell.pos-e),n=t.colCount(this.$headCell.pos-e);if(Math.min(r,n)>0)return!1;var o=r+this.$anchorCell.nodeAfter.attrs.colspan,i=n+this.$headCell.nodeAfter.attrs.colspan;return Math.max(o,i)==t.width},e.prototype.eq=function(t){return t instanceof e&&t.$anchorCell.pos==this.$anchorCell.pos&&t.$headCell.pos==this.$headCell.pos},e.rowSelection=function(t,r){void 0===r&&(r=t);var n=d.get(t.node(-1)),o=t.start(-1),i=n.findCell(t.pos-o),a=n.findCell(r.pos-o),s=t.node(0);return i.left<=a.left?(i.left>0&&(t=s.resolve(o+n.map[i.top*n.width])),a.right<n.width&&(r=s.resolve(o+n.map[n.width*(a.top+1)-1]))):(a.left>0&&(r=s.resolve(o+n.map[a.top*n.width])),i.right<n.width&&(t=s.resolve(o+n.map[n.width*(i.top+1)-1]))),new e(t,r)},e.prototype.toJSON=function(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}},e.fromJSON=function(t,r){return new e(t.resolve(r.anchor),t.resolve(r.head))},e.create=function(t,r,n){return void 0===n&&(n=r),new e(t.resolve(r),t.resolve(n))},e.prototype.getBookmark=function(){return new _(this.$anchorCell.pos,this.$headCell.pos)},e}(i.f);z.prototype.visible=!1,i.f.jsonID("cell",z);var _=function(t,e){this.anchor=t,this.head=e};function x(t){if(!(t.selection instanceof z))return null;var e=[];return t.selection.forEachCell((function(t,r){e.push(l.a.node(r,r+t.nodeSize,{class:"selectedCell"}))})),l.b.create(t.doc,e)}function E(t){if(!t.size)return null;for(var e=t.content,r=t.openStart,n=t.openEnd;1==e.childCount&&(r>0&&n>0||"table"==e.firstChild.type.spec.tableRole);)r--,n--,e=e.firstChild.content;var o=e.firstChild,i=o.type.spec.tableRole,s=o.type.schema,l=[];if("row"==i)for(var c=0;c<e.childCount;c++){var p=e.child(c).content,u=c?0:Math.max(0,r-1),h=c<e.childCount-1?0:Math.max(0,n-1);(u||h)&&(p=D(y(s).row,new a.j(p,u,h)).content),l.push(p)}else{if("cell"!=i&&"header_cell"!=i)return null;l.push(r||n?D(y(s).row,new a.j(e,r,n)).content:e)}return function(t,e){for(var r=[],n=0;n<e.length;n++)for(var o=e[n],i=o.childCount-1;i>=0;i--)for(var s=o.child(i).attrs,l=s.rowspan,c=s.colspan,p=n;p<n+l;p++)r[p]=(r[p]||0)+c;for(var u=0,h=0;h<r.length;h++)u=Math.max(u,r[h]);for(var f=0;f<r.length;f++)if(f>=e.length&&e.push(a.c.empty),r[f]<u){for(var d=y(t).cell.createAndFill(),v=[],m=r[f];m<u;m++)v.push(d);e[f]=e[f].append(a.c.from(v))}return{height:e.length,width:u,rows:e}}(s,l)}function D(t,e){var r=t.createAndFill();return new c.e(r).replace(0,r.content.size,e).doc}function j(t,e,r,n,o,i,a,s){if(0==a||a==e.height)return!1;for(var l=!1,c=o;c<i;c++){var p=a*e.width+c,u=e.map[p];if(e.map[p-e.width]==u){l=!0;var h=r.nodeAt(u),f=e.findCell(u),d=f.top,v=f.left;t.setNodeMarkup(t.mapping.slice(s).map(u+n),null,N(h.attrs,"rowspan",a-d)),t.insert(t.mapping.slice(s).map(e.positionAt(a,v,r)),h.type.createAndFill(N(h.attrs,"rowspan",d+h.attrs.rowspan-a))),c+=h.attrs.colspan-1}}return l}function F(t,e,r,n,o,i,a,s){if(0==a||a==e.width)return!1;for(var l=!1,c=o;c<i;c++){var p=c*e.width+a,u=e.map[p];if(e.map[p-1]==u){l=!0;var h=r.nodeAt(u),f=e.colCount(u),d=t.mapping.slice(s).map(u+n);t.setNodeMarkup(d,null,R(h.attrs,a-f,h.attrs.colspan-(a-f))),t.insert(d+h.nodeSize,h.type.createAndFill(R(h.attrs,0,a-f))),c+=h.attrs.rowspan-1}}return l}function T(t,e,r,n,o){var i=r?t.doc.nodeAt(r-1):t.doc,s=d.get(i),l=n.top,c=n.left,p=c+o.width,u=l+o.height,h=t.tr,f=0;function v(){i=r?h.doc.nodeAt(r-1):h.doc,s=d.get(i),f=h.mapping.maps.length}(function(t,e,r,n,o,i,s){var l,c,p=y(t.doc.type.schema);if(o>e.width)for(var u=0,h=0;u<e.height;u++){var f=r.child(u);h+=f.nodeSize;var d=[],v=void 0;v=null==f.lastChild||f.lastChild.type==p.cell?l||(l=p.cell.createAndFill()):c||(c=p.header_cell.createAndFill());for(var m=e.width;m<o;m++)d.push(v);t.insert(t.mapping.slice(s).map(h-1+n),d)}if(i>e.height){for(var g=[],w=0,b=(e.height-1)*e.width;w<Math.max(e.width,o);w++){var S=!(w>=e.width)&&r.nodeAt(e.map[b+w]).type==p.header_cell;g.push(S?c||(c=p.header_cell.createAndFill()):l||(l=p.cell.createAndFill()))}for(var C=p.row.create(null,a.c.from(g)),$=[],k=e.height;k<i;k++)$.push(C);t.insert(t.mapping.slice(s).map(n+r.nodeSize-2),$)}return!(!l&&!c)})(h,s,i,r,p,u,f)&&v(),j(h,s,i,r,c,p,l,f)&&v(),j(h,s,i,r,c,p,u,f)&&v(),F(h,s,i,r,l,u,c,f)&&v(),F(h,s,i,r,l,u,p,f)&&v();for(var m=l;m<u;m++){var g=s.positionAt(m,c,i),w=s.positionAt(m,p,i);h.replace(h.mapping.slice(f).map(g+r),h.mapping.slice(f).map(w+r),new a.j(o.rows[m-l],0,0))}v(),h.setSelection(new z(h.doc.resolve(r+s.positionAt(l,c,i)),h.doc.resolve(r+s.positionAt(u-1,p-1,i)))),e(h)}_.prototype.map=function(t){return new _(t.map(this.anchor),t.map(this.head))},_.prototype.resolve=function(t){var e=t.resolve(this.anchor),r=t.resolve(this.head);return"row"==e.parent.type.spec.tableRole&&"row"==r.parent.type.spec.tableRole&&e.index()<e.parent.childCount&&r.index()<r.parent.childCount&&A(e,r)?new z(e,r):i.f.near(r,1)};var J=Object(s.a)({ArrowLeft:B("horiz",-1),ArrowRight:B("horiz",1),ArrowUp:B("vert",-1),ArrowDown:B("vert",1),"Shift-ArrowLeft":L("horiz",-1),"Shift-ArrowRight":L("horiz",1),"Shift-ArrowUp":L("vert",-1),"Shift-ArrowDown":L("vert",1),Backspace:W,"Mod-Backspace":W,Delete:W,"Mod-Delete":W});function I(t,e,r){return!r.eq(t.selection)&&(e&&e(t.tr.setSelection(r).scrollIntoView()),!0)}function B(t,e){return function(r,n,o){var a=r.selection;if(a instanceof z)return I(r,n,i.f.near(a.$headCell,e));if("horiz"!=t&&!a.empty)return!1;var s=V(o,t,e);if(null==s)return!1;if("horiz"==t)return I(r,n,i.f.near(r.doc.resolve(a.head+e),e));var l,c=r.doc.resolve(s),p=M(c,t,e);return l=p?i.f.near(p,1):e<0?i.f.near(r.doc.resolve(c.before(-1)),-1):i.f.near(r.doc.resolve(c.after(-1)),1),I(r,n,l)}}function L(t,e){return function(r,n,o){var i=r.selection;if(!(i instanceof z)){var a=V(o,t,e);if(null==a)return!1;i=new z(r.doc.resolve(a))}var s=M(i.$headCell,t,e);return!!s&&I(r,n,new z(i.$anchorCell,s))}}function W(t,e){var r=t.selection;if(!(r instanceof z))return!1;if(e){var n=t.tr,o=y(t.schema).cell.createAndFill().content;r.forEachCell((function(t,e){t.content.eq(o)||n.replace(n.mapping.map(e+1),n.mapping.map(e+t.nodeSize-1),new a.j(o,0,0))})),n.docChanged&&e(n)}return!0}function H(t,e){var r=S(t.state.doc.resolve(e));return!!r&&(t.dispatch(t.state.tr.setSelection(new z(r))),!0)}function q(t,e,r){if(!C(t.state))return!1;var n=E(r),o=t.state.selection;if(o instanceof z){n||(n={width:1,height:1,rows:[a.c.from(D(y(t.state.schema).cell,r))]});var i=o.$anchorCell.node(-1),s=o.$anchorCell.start(-1),l=d.get(i).rectBetween(o.$anchorCell.pos-s,o.$headCell.pos-s);return n=function(t,e,r){var n=t.width,o=t.height,i=t.rows;if(n!=e){for(var s=[],l=[],c=0;c<i.length;c++){for(var p=i[c],u=[],h=s[c]||0,f=0;h<e;f++){var d=p.child(f%p.childCount);h+d.attrs.colspan>e&&(d=d.type.create(R(d.attrs,d.attrs.colspan,h+d.attrs.colspan-e),d.content)),u.push(d),h+=d.attrs.colspan;for(var v=1;v<d.attrs.rowspan;v++)s[c+v]=(s[c+v]||0)+d.attrs.colspan}l.push(a.c.from(u))}i=l,n=e}if(o!=r){for(var m=[],g=0,w=0;g<r;g++,w++){for(var y=[],b=i[w%o],S=0;S<b.childCount;S++){var C=b.child(S);g+C.attrs.rowspan>r&&(C=C.type.create(N(C.attrs,"rowspan",Math.max(1,r-C.attrs.rowspan)),C.content)),y.push(C)}m.push(a.c.from(y))}i=m,o=r}return{width:n,height:o,rows:i}}(n,l.right-l.left,l.bottom-l.top),T(t.state,t.dispatch,s,l,n),!0}if(n){var c=$(t.state),p=c.start(-1);return T(t.state,t.dispatch,p,d.get(c.node(-1)).findCell(c.pos-p),n),!0}return!1}function P(t,e){if(!e.ctrlKey&&!e.metaKey){var r,n=K(t,e.target);if(e.shiftKey&&t.state.selection instanceof z)o(t.state.selection.$anchorCell,e),e.preventDefault();else if(e.shiftKey&&n&&null!=(r=S(t.state.selection.$anchor))&&X(t,e).pos!=r.pos)o(r,e),e.preventDefault();else if(!n)return;t.root.addEventListener("mouseup",i),t.root.addEventListener("dragstart",i),t.root.addEventListener("mousemove",a)}function o(e,r){var n=X(t,r),o=null==b.getState(t.state);if(!n||!A(e,n)){if(!o)return;n=e}var i=new z(e,n);if(o||!t.state.selection.eq(i)){var a=t.state.tr.setSelection(i);o&&a.setMeta(b,e.pos),t.dispatch(a)}}function i(){t.root.removeEventListener("mouseup",i),t.root.removeEventListener("dragstart",i),t.root.removeEventListener("mousemove",a),null!=b.getState(t.state)&&t.dispatch(t.state.tr.setMeta(b,-1))}function a(r){var a,s=b.getState(t.state);if(null!=s)a=t.state.doc.resolve(s);else if(K(t,r.target)!=n&&!(a=X(t,e)))return i();a&&o(a,r)}}function V(t,e,r){if(!(t.state.selection instanceof i.h))return null;for(var n=t.state.selection.$head,o=n.depth-1;o>=0;o--){var a=n.node(o);if((r<0?n.index(o):n.indexAfter(o))!=(r<0?0:a.childCount))return null;if("cell"==a.type.spec.tableRole||"header_cell"==a.type.spec.tableRole){var s=n.before(o),l="vert"==e?r>0?"down":"up":r>0?"right":"left";return t.endOfTextblock(l)?s:null}}return null}function K(t,e){for(;e&&e!=t.dom;e=e.parentNode)if("TD"==e.nodeName||"TH"==e.nodeName)return e}function X(t,e){var r=t.posAtCoords({left:e.clientX,top:e.clientY});return r&&r?S(t.state.doc.resolve(r.pos)):null}var G=new i.e("fix-tables");function U(t,e){var r,n=function(e,n){"table"==e.type.spec.tableRole&&(r=function(t,e,r,n){var o=d.get(e);if(!o.problems)return n;n||(n=t.tr);for(var i,a,s=[],l=0;l<o.height;l++)s.push(0);for(var c=0;c<o.problems.length;c++){var p=o.problems[c];if("collision"==p.type){for(var u=e.nodeAt(p.pos),h=0;h<u.attrs.rowspan;h++)s[p.row+h]+=p.n;n.setNodeMarkup(n.mapping.map(r+1+p.pos),null,R(u.attrs,u.attrs.colspan-p.n,p.n))}else if("missing"==p.type)s[p.row]+=p.n;else if("overlong_rowspan"==p.type){var f=e.nodeAt(p.pos);n.setNodeMarkup(n.mapping.map(r+1+p.pos),null,N(f.attrs,"rowspan",f.attrs.rowspan-p.n))}else if("colwidth mismatch"==p.type){var v=e.nodeAt(p.pos);n.setNodeMarkup(n.mapping.map(r+1+p.pos),null,N(v.attrs,"colwidth",p.colwidth))}}for(var m=0;m<s.length;m++)s[m]&&(null==i&&(i=m),a=m);for(var g=0,w=r+1;g<o.height;g++){var b=e.child(g),S=w+b.nodeSize,C=s[g];if(C>0){var $="cell";b.firstChild&&($=b.firstChild.type.spec.tableRole);for(var k=[],A=0;A<C;A++)k.push(y(t.schema)[$].createAndFill());var M=0!=g&&i!=g-1||a!=g?S-1:w+1;n.insert(n.mapping.map(M),k)}w=S}return n.setMeta(G,{fixTables:!0})}(t,e,n,r))};return e?e.doc!=t.doc&&function t(e,r,n,o){var i=e.childCount,a=r.childCount;t:for(var s=0,l=0;s<a;s++){for(var c=r.child(s),p=l,u=Math.min(i,s+3);p<u;p++)if(e.child(p)==c){l=p+1,n+=c.nodeSize;continue t}o(c,n),l<i&&e.child(l).sameMarkup(c)?t(e.child(l),c,n+1,o):c.nodesBetween(0,c.content.size,o,n+1),n+=c.nodeSize}}(e.doc,t.doc,0,n):t.doc.descendants(n),r}function Y(t){var e,r=t.selection,n=$(t),o=n.node(-1),i=n.start(-1),a=d.get(o);return(e=r instanceof z?a.rectBetween(r.$anchorCell.pos-i,r.$headCell.pos-i):a.findCell(n.pos-i)).tableStart=i,e.map=a,e.table=o,e}function Q(t,e,r){var n=e.map,o=e.tableStart,i=e.table,a=r>0?-1:0;(function(t,e,r){for(var n=y(e.type.schema).header_cell,o=0;o<t.height;o++)if(e.nodeAt(t.map[r+o*t.width]).type!=n)return!1;return!0})(n,i,r+a)&&(a=0==r||r==n.width?null:0);for(var s=0;s<n.height;s++){var l=s*n.width+r;if(r>0&&r<n.width&&n.map[l-1]==n.map[l]){var c=n.map[l],p=i.nodeAt(c);t.setNodeMarkup(t.mapping.map(o+c),null,O(p.attrs,r-n.colCount(c))),s+=p.attrs.rowspan-1}else{var u=null==a?y(i.type.schema).cell:i.nodeAt(n.map[l+a]).type,h=n.positionAt(s,r,i);t.insert(t.mapping.map(o+h),u.createAndFill())}}return t}function Z(t,e){if(!C(t))return!1;if(e){var r=Y(t);e(Q(t.tr,r,r.left))}return!0}function tt(t,e){if(!C(t))return!1;if(e){var r=Y(t);e(Q(t.tr,r,r.right))}return!0}function et(t,e,r){for(var n=e.map,o=e.table,i=e.tableStart,a=t.mapping.maps.length,s=0;s<n.height;){var l=s*n.width+r,c=n.map[l],p=o.nodeAt(c);if(r>0&&n.map[l-1]==c||r<n.width-1&&n.map[l+1]==c)t.setNodeMarkup(t.mapping.slice(a).map(i+c),null,R(p.attrs,r-n.colCount(c)));else{var u=t.mapping.slice(a).map(i+c);t.delete(u,u+p.nodeSize)}s+=p.attrs.rowspan}}function rt(t,e){if(!C(t))return!1;if(e){var r=Y(t),n=t.tr;if(0==r.left&&r.right==r.map.width)return!1;for(var o=r.right-1;et(n,r,o),o!=r.left;o--)r.table=r.tableStart?n.doc.nodeAt(r.tableStart-1):n.doc,r.map=d.get(r.table);e(n)}return!0}function nt(t,e,r){for(var n=e.map,o=e.tableStart,i=e.table,a=o,s=0;s<r;s++)a+=i.child(s).nodeSize;var l=[],c=r>0?-1:0;(function(t,e,r){for(var n=y(e.type.schema).header_cell,o=0;o<t.width;o++)if(e.nodeAt(t.map[o+r*t.width]).type!=n)return!1;return!0})(n,i,r+c)&&(c=0==r||r==n.height?null:0);for(var p=0,u=n.width*r;p<n.width;p++,u++)if(r>0&&r<n.height&&n.map[u]==n.map[u-n.width]){var h=n.map[u],f=i.nodeAt(h).attrs;t.setNodeMarkup(o+h,null,N(f,"rowspan",f.rowspan+1)),p+=f.colspan-1}else{var d=null==c?y(i.type.schema).cell:i.nodeAt(n.map[u+c*n.width]).type;l.push(d.createAndFill())}return t.insert(a,y(i.type.schema).row.create(null,l)),t}function ot(t,e){if(!C(t))return!1;if(e){var r=Y(t);e(nt(t.tr,r,r.top))}return!0}function it(t,e){if(!C(t))return!1;if(e){var r=Y(t);e(nt(t.tr,r,r.bottom))}return!0}function at(t,e,r){for(var n=e.map,o=e.table,i=e.tableStart,a=0,s=0;s<r;s++)a+=o.child(s).nodeSize;var l=a+o.child(r).nodeSize,c=t.mapping.maps.length;t.delete(a+i,l+i);for(var p=0,u=r*n.width;p<n.width;p++,u++){var h=n.map[u];if(r>0&&h==n.map[u-n.width]){var f=o.nodeAt(h).attrs;t.setNodeMarkup(t.mapping.slice(c).map(h+i),null,N(f,"rowspan",f.rowspan-1)),p+=f.colspan-1}else if(r<n.width&&h==n.map[u+n.width]){var d=o.nodeAt(h),v=d.type.create(N(d.attrs,"rowspan",d.attrs.rowspan-1),d.content),m=n.positionAt(r+1,p,o);t.insert(t.mapping.slice(c).map(i+m),v),p+=d.attrs.colspan-1}}}function st(t,e){if(!C(t))return!1;if(e){var r=Y(t),n=t.tr;if(0==r.top&&r.bottom==r.map.height)return!1;for(var o=r.bottom-1;at(n,r,o),o!=r.top;o--)r.table=r.tableStart?n.doc.nodeAt(r.tableStart-1):n.doc,r.map=d.get(r.table);e(n)}return!0}function lt(t){var e=t.content;return 1==e.childCount&&e.firstChild.isTextblock&&0==e.firstChild.childCount}function ct(t,e){var r=t.selection;if(!(r instanceof z)||r.$anchorCell.pos==r.$headCell.pos)return!1;var n=Y(t),o=n.map;if(function(t,e){for(var r=t.width,n=t.height,o=t.map,i=e.top*r+e.left,a=i,s=(e.bottom-1)*r+e.left,l=i+(e.right-e.left-1),c=e.top;c<e.bottom;c++){if(e.left>0&&o[a]==o[a-1]||e.right<r&&o[l]==o[l+1])return!0;a+=r,l+=r}for(var p=e.left;p<e.right;p++){if(e.top>0&&o[i]==o[i-r]||e.bottom<n&&o[s]==o[s+r])return!0;i++,s++}return!1}(o,n))return!1;if(e){for(var i,s,l=t.tr,c={},p=a.c.empty,u=n.top;u<n.bottom;u++)for(var h=n.left;h<n.right;h++){var f=o.map[u*o.width+h],d=n.table.nodeAt(f);if(!c[f])if(c[f]=!0,null==i)i=f,s=d;else{lt(d)||(p=p.append(d.content));var v=l.mapping.map(f+n.tableStart);l.delete(v,v+d.nodeSize)}}if(l.setNodeMarkup(i+n.tableStart,null,N(O(s.attrs,s.attrs.colspan,n.right-n.left-s.attrs.colspan),"rowspan",n.bottom-n.top)),p.size){var m=i+1+s.content.size,g=lt(s)?i+1:m;l.replaceWith(g+n.tableStart,m+n.tableStart,p)}l.setSelection(new z(l.doc.resolve(i+n.tableStart))),e(l)}return!0}function pt(t,e){var r,n=y(t.schema);return(r=function(t){var e=t.node;return n[e.type.spec.tableRole]},function(t,e){var n,o,i=t.selection;if(i instanceof z){if(i.$anchorCell.pos!=i.$headCell.pos)return!1;n=i.$anchorCell.nodeAfter,o=i.$anchorCell.pos}else{if(!(n=function(t){for(var e=t.depth;e>0;e--){var r=t.node(e).type.spec.tableRole;if("cell"===r||"header_cell"===r)return t.node(e)}return null}(i.$from)))return!1;o=S(i.$from).pos}if(1==n.attrs.colspan&&1==n.attrs.rowspan)return!1;if(e){var a=n.attrs,s=[],l=a.colwidth;a.rowspan>1&&(a=N(a,"rowspan",1)),a.colspan>1&&(a=N(a,"colspan",1));for(var c,p=Y(t),u=t.tr,h=0;h<p.right-p.left;h++)s.push(l?N(a,"colwidth",l&&l[h]?[l[h]]:null):a);for(var f=p.top;f<p.bottom;f++){var d=p.map.positionAt(f,p.left,p.table);f==p.top&&(d+=n.nodeSize);for(var v=p.left,m=0;v<p.right;v++,m++)v==p.left&&f==p.top||u.insert(c=u.mapping.map(d+p.tableStart,1),r({node:n,row:f,col:v}).createAndFill(s[m]))}u.setNodeMarkup(o,r({node:n,row:p.top,col:p.left}),s[0]),i instanceof z&&u.setSelection(new z(u.doc.resolve(i.$anchorCell.pos),c&&u.doc.resolve(c))),e(u)}return!0})(t,e)}function ut(t,e){return function(r,n){if(!C(r))return!1;var o=$(r);if(o.nodeAfter.attrs[t]===e)return!1;if(n){var i=r.tr;r.selection instanceof z?r.selection.forEachCell((function(r,n){r.attrs[t]!==e&&i.setNodeMarkup(n,null,N(r.attrs,t,e))})):i.setNodeMarkup(o.pos,null,N(o.nodeAfter.attrs,t,e)),n(i)}return!0}}function ht(t,e,r){for(var n=e.map.cellsInRect({left:0,top:0,right:"row"==t?e.map.width:1,bottom:"column"==t?e.map.height:1}),o=0;o<n.length;o++){var i=e.table.nodeAt(n[o]);if(i&&i.type!==r.header_cell)return!1}return!0}function ft(t,e){return(e=e||{useDeprecatedLogic:!1}).useDeprecatedLogic?function(t){return function(e,r){if(!C(e))return!1;if(r){for(var n=y(e.schema),o=Y(e),i=e.tr,a=o.map.cellsInRect("column"==t?new f(o.left,0,o.right,o.map.height):"row"==t?new f(0,o.top,o.map.width,o.bottom):o),s=a.map((function(t){return o.table.nodeAt(t)})),l=0;l<a.length;l++)s[l].type==n.header_cell&&i.setNodeMarkup(o.tableStart+a[l],n.cell,s[l].attrs);if(0==i.steps.length)for(var c=0;c<a.length;c++)i.setNodeMarkup(o.tableStart+a[c],n.header_cell,s[c].attrs);r(i)}return!0}}(t):function(e,r){if(!C(e))return!1;if(r){var n=y(e.schema),o=Y(e),i=e.tr,a=ht("row",o,n),s=ht("column",o,n),l=("column"===t?a:"row"===t&&s)?1:0,c="column"==t?new f(0,l,1,o.map.height):"row"==t?new f(l,0,o.map.width,1):o,p="column"==t?s?n.cell:n.header_cell:"row"==t?a?n.cell:n.header_cell:n.cell;o.map.cellsInRect(c).forEach((function(t){var e=t+o.tableStart,r=i.doc.nodeAt(e);r&&i.setNodeMarkup(e,p,r.attrs)})),r(i)}return!0}}var dt=ft("row",{useDeprecatedLogic:!0}),vt=ft("column",{useDeprecatedLogic:!0}),mt=ft("cell",{useDeprecatedLogic:!0});function gt(t){return function(e,r){if(!C(e))return!1;var n=function(t,e){if(e<0){var r=t.nodeBefore;if(r)return t.pos-r.nodeSize;for(var n=t.index(-1)-1,o=t.before();n>=0;n--){var i=t.node(-1).child(n);if(i.childCount)return o-1-i.lastChild.nodeSize;o-=i.nodeSize}}else{if(t.index()<t.parent.childCount-1)return t.pos+t.nodeAfter.nodeSize;for(var a=t.node(-1),s=t.indexAfter(-1),l=t.after();s<a.childCount;s++){var c=a.child(s);if(c.childCount)return l+1;l+=c.nodeSize}}}($(e),t);if(null!=n){if(r){var o=e.doc.resolve(n);r(e.tr.setSelection(i.h.between(o,(a=o,a.node(0).resolve(a.pos+a.nodeAfter.nodeSize)))).scrollIntoView())}var a;return!0}}}function wt(t,e){for(var r=t.selection.$anchor,n=r.depth;n>0;n--){if("table"==r.node(n).type.spec.tableRole)return e&&e(t.tr.delete(r.before(n),r.after(n)).scrollIntoView()),!0}return!1}var yt=function(t,e){this.node=t,this.cellMinWidth=e,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),bt(t,this.colgroup,this.table,e),this.contentDOM=this.table.appendChild(document.createElement("tbody"))};function bt(t,e,r,n,o,i){for(var a=0,s=!0,l=e.firstChild,c=t.firstChild,p=0,u=0;p<c.childCount;p++)for(var h=c.child(p).attrs,f=h.colspan,d=h.colwidth,v=0;v<f;v++,u++){var m=o==u?i:d&&d[v],g=m?m+"px":"";a+=m||n,m||(s=!1),l?(l.style.width!=g&&(l.style.width=g),l=l.nextSibling):e.appendChild(document.createElement("col")).style.width=g}for(;l;){var w=l.nextSibling;l.parentNode.removeChild(l),l=w}s?(r.style.width=a+"px",r.style.minWidth=""):(r.style.width="",r.style.minWidth=a+"px")}yt.prototype.update=function(t){return t.type==this.node.type&&(this.node=t,bt(t,this.colgroup,this.table,this.cellMinWidth),!0)},yt.prototype.ignoreMutation=function(t){return"attributes"==t.type&&(t.target==this.table||this.colgroup.contains(t.target))};var St=new i.e("tableColumnResizing");function Ct(t){void 0===t&&(t={});var e=t.handleWidth;void 0===e&&(e=5);var r=t.cellMinWidth;void 0===r&&(r=25);var n=t.View;void 0===n&&(n=yt);var o=t.lastColumnResizable;return void 0===o&&(o=!0),new i.d({key:St,state:{init:function(t,e){return this.spec.props.nodeViews[y(e.schema).table.name]=function(t,e){return new n(t,r,e)},new $t(-1,!1)},apply:function(t,e){return e.apply(t)}},props:{attributes:function(t){return St.getState(t).activeHandle>-1?{class:"resize-cursor"}:null},handleDOMEvents:{mousemove:function(t,r){!function(t,e,r,n,o){var i=St.getState(t.state);if(!i.dragging){var a=function(t){for(;t&&"TD"!=t.nodeName&&"TH"!=t.nodeName;)t=t.classList.contains("ProseMirror")?null:t.parentNode;return t}(e.target),s=-1;if(a){var l=a.getBoundingClientRect(),c=l.left,p=l.right;e.clientX-c<=r?s=kt(t,e,"left"):p-e.clientX<=r&&(s=kt(t,e,"right"))}if(s!=i.activeHandle){if(!o&&-1!==s){var u=t.state.doc.resolve(s),h=u.node(-1),f=d.get(h),v=u.start(-1);if(f.colCount(u.pos-v)+u.nodeAfter.attrs.colspan-1==f.width-1)return}Mt(t,s)}}}(t,r,e,0,o)},mouseleave:function(t){!function(t){var e=St.getState(t.state);e.activeHandle>-1&&!e.dragging&&Mt(t,-1)}(t)},mousedown:function(t,e){!function(t,e,r){var n=St.getState(t.state);if(-1==n.activeHandle||n.dragging)return!1;var o=t.state.doc.nodeAt(n.activeHandle),i=function(t,e,r){var n=r.colspan,o=r.colwidth,i=o&&o[o.length-1];if(i)return i;var a=t.domAtPos(e),s=a.node.childNodes[a.offset].offsetWidth,l=n;if(o)for(var c=0;c<n;c++)o[c]&&(s-=o[c],l--);return s/l}(t,n.activeHandle,o.attrs);function a(e){window.removeEventListener("mouseup",a),window.removeEventListener("mousemove",s);var n=St.getState(t.state);n.dragging&&(!function(t,e,r){for(var n=t.state.doc.resolve(e),o=n.node(-1),i=d.get(o),a=n.start(-1),s=i.colCount(n.pos-a)+n.nodeAfter.attrs.colspan-1,l=t.state.tr,c=0;c<i.height;c++){var p=c*i.width+s;if(!c||i.map[p]!=i.map[p-i.width]){var u=i.map[p],h=o.nodeAt(u).attrs,f=1==h.colspan?0:s-i.colCount(u);if(!h.colwidth||h.colwidth[f]!=r){var v=h.colwidth?h.colwidth.slice():Nt(h.colspan);v[f]=r,l.setNodeMarkup(a+u,null,N(h,"colwidth",v))}}}l.docChanged&&t.dispatch(l)}(t,n.activeHandle,At(n.dragging,e,r)),t.dispatch(t.state.tr.setMeta(St,{setDragging:null})))}function s(e){if(!e.which)return a(e);var n=St.getState(t.state),o=At(n.dragging,e,r);!function(t,e,r,n){var o=t.state.doc.resolve(e),i=o.node(-1),a=o.start(-1),s=d.get(i).colCount(o.pos-a)+o.nodeAfter.attrs.colspan-1,l=t.domAtPos(o.start(-1)).node;for(;"TABLE"!=l.nodeName;)l=l.parentNode;bt(i,l.firstChild,l,n,s,r)}(t,n.activeHandle,o,r)}t.dispatch(t.state.tr.setMeta(St,{setDragging:{startX:e.clientX,startWidth:i}})),window.addEventListener("mouseup",a),window.addEventListener("mousemove",s),e.preventDefault()}(t,e,r)}},decorations:function(t){var e=St.getState(t);if(e.activeHandle>-1)return function(t,e){for(var r=[],n=t.doc.resolve(e),o=n.node(-1),i=d.get(o),a=n.start(-1),s=i.colCount(n.pos-a)+n.nodeAfter.attrs.colspan,c=0;c<i.height;c++){var p=s+c*i.width-1;if(!(s!=i.width&&i.map[p]==i.map[p+1]||0!=c&&i.map[p-1]==i.map[p-1-i.width])){var u=i.map[p],h=a+u+o.nodeAt(u).nodeSize-1,f=document.createElement("div");f.className="column-resize-handle",r.push(l.a.widget(h,f))}}return l.b.create(t.doc,r)}(t,e.activeHandle)},nodeViews:{}}})}var $t=function(t,e){this.activeHandle=t,this.dragging=e};function kt(t,e,r){var n=t.posAtCoords({left:e.clientX,top:e.clientY});if(!n)return-1;var o=n.pos,i=S(t.state.doc.resolve(o));if(!i)return-1;if("right"==r)return i.pos;var a=d.get(i.node(-1)),s=i.start(-1),l=a.map.indexOf(i.pos-s);return l%a.width==0?-1:s+a.map[l-1]}function At(t,e,r){var n=e.clientX-t.startX;return Math.max(r,t.startWidth+n)}function Mt(t,e){t.dispatch(t.state.tr.setMeta(St,{setHandle:e}))}function Nt(t){for(var e=[],r=0;r<t;r++)e.push(0);return e}function Rt(t){void 0===t&&(t={});var e=t.allowTableNodeSelection;return void 0===e&&(e=!1),new i.d({key:b,state:{init:function(){return null},apply:function(t,e){var r=t.getMeta(b);if(null!=r)return-1==r?null:r;if(null==e||!t.docChanged)return e;var n=t.mapping.mapResult(e),o=n.deleted,i=n.pos;return o?null:i}},props:{decorations:x,handleDOMEvents:{mousedown:P},createSelectionBetween:function(t){if(null!=b.getState(t.state))return t.state.selection},handleTripleClick:H,handleKeyDown:J,handlePaste:q},appendTransaction:function(t,r,n){return function(t,e,r){var n,o,a=(e||t).selection,s=(e||t).doc;if(a instanceof i.c&&(o=a.node.type.spec.tableRole)){if("cell"==o||"header_cell"==o)n=z.create(s,a.from);else if("row"==o){var l=s.resolve(a.from+1);n=z.rowSelection(l,l)}else if(!r){var c=d.get(a.node),p=a.from+1,u=p+c.map[c.width*c.height-1];n=z.create(s,p+1,u)}}else a instanceof i.h&&function(t){var e=t.$from,r=t.$to;if(e.pos==r.pos||e.pos<e.pos-6)return!1;for(var n=e.pos,o=r.pos,i=e.depth;i>=0&&!(e.after(i+1)<e.end(i));i--,n++);for(var a=r.depth;a>=0&&!(r.before(a+1)>r.start(a));a--,o--);return n==o&&/row|table/.test(e.node(i).type.spec.tableRole)}(a)?n=i.h.create(s,a.from):a instanceof i.h&&function(t){for(var e,r,n=t.$from,o=t.$to,i=n.depth;i>0;i--){var a=n.node(i);if("cell"===a.type.spec.tableRole||"header_cell"===a.type.spec.tableRole){e=a;break}}for(var s=o.depth;s>0;s--){var l=o.node(s);if("cell"===l.type.spec.tableRole||"header_cell"===l.type.spec.tableRole){r=l;break}}return e!==r&&0===o.parentOffset}(a)&&(n=i.h.create(s,a.$from.start(),a.$from.end()));return n&&(e||(e=t.tr)).setSelection(n),e}(n,U(n,r),e)}})}$t.prototype.apply=function(t){var e=this,r=t.getMeta(St);if(r&&null!=r.setHandle)return new $t(r.setHandle,null);if(r&&void 0!==r.setDragging)return new $t(e.activeHandle,r.setDragging);if(e.activeHandle>-1&&t.docChanged){var n=t.mapping.map(e.activeHandle,-1);k(t.doc.resolve(n))||(n=null),e=new $t(n,e.dragging)}return e}}}]);