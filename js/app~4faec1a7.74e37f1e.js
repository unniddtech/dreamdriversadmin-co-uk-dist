(window.webpackJsonp=window.webpackJsonp||[]).push([["app~4faec1a7"],{"0aa9":function(e,t,a){"use strict";var s=a("c1df"),i=a.n(s),n=a("2b0e"),o=a("2ef0"),l=a("fcb3"),r=a.n(l),c=a("2f62"),d=a("156f"),p=a("1168"),v={name:"Invoices",data:()=>({TYPE_AREA:d.b,TYPE_RESTAURANT:d.c,interval_list:[{id:p.b,name:"Day",$isDisabled:!0},{id:p.e,name:"Week"},{id:p.d,name:"2-Week"},{id:p.c,name:"Month"}],localLoading:!1,config:r.a,date_range_selected:null,period_date_selected:null,successMessage:"",sortLocationAsc:!0,showSnackbar:!1,snackbarColor:"green",showPayTooltip:!1,paymentProcessing:!1,menu_date_picker:!1,location_selected:void 0,interval_selected_id:p.e,invoice_comission_default:void 0,invoice_comission:void 0,mark_as_paid:!1}),computed:{...Object(c.c)({locations_list:"locations",area_list:"areas",restaurant_list:"restaurants",invoices_list:"invoices",options:"options"}),restaurantListSearched(){if(!this.$data.location_selected)return this.restaurant_list;if(this.$data.location_selected.type==d.b)return o.filter(this.restaurant_list,e=>e.area_id==this.$data.location_selected.id);if(this.$data.location_selected.type==d.c){let e=o.find(this.restaurant_list,e=>e.id==this.$data.location_selected.id);return e?[e]:[]}return this.restaurant_list},invoicesSeached(){let e=this.invoices_list||[];if(void 0!==this.$data.location_selected){const t=this.restaurantListSearched.map(e=>+e.id);e=e.filter(e=>t.includes(+e.restaurant_id))}return e=o.orderBy(e,e=>e.period_date_from),e.sort((e,t)=>{const a=this.getRestaurantNameByID(e.restaurant_id)+this.getAreaLabel(e.restaurant_id),s=this.getRestaurantNameByID(t.restaurant_id)+this.getAreaLabel(t.restaurant_id);return this.sortLocationAsc?a.localeCompare(s):s.localeCompare(a)})}},watch:{period_date:function(e){this.$data.period_date_selected!=e&&(this.$data.period_date_selected=e,this.dateRangeSelect())},location_selected:function(e){if(this.invoice_comission=this.invoice_comission_default,e&&e.type==d.c){let t=o.find(this.restaurant_list,t=>+t.id==+e.id);t&&t.invoice_comission&&(this.invoice_comission=t.invoice_comission)}}},mounted(){Promise.all([this.$store.dispatch("fetchLocations"),this.$store.dispatch("fetchOptions")]).then(()=>{let e=i()();this.$data.date_range_selected=[e.startOf("isoWeek").format("YYYY-MM-DD"),null];let t=o.find(this.options,e=>"restaurants_standard_invoice_comission"==e.okey);t&&t.ovalue&&(this.invoice_comission_default=t.ovalue),this.dateRangeSelect()})},methods:{moment:i.a,onPayInvoice(e){e&&0===e.payment_status?(this.localLoading=!0,this.paymentProcessing=!0,this.showSnackbarMessage("Processing payment...","blue"),this.$store.dispatch("payInvoiceNow",{invoice_number:e.invoice_number,stripe_customer_id:e.stripe_customer_id,amount:e.freeagent_invoice.total_value,freeagent_invoice_reference:e.freeagent_invoice.reference}).then(e=>{this.successMessage=e.message,this.snackbarColor=e.success?"green":"red",this.showSnackbar=!0,setTimeout(()=>{e.success&&this.dateRangeSelect()},5e3)}).catch(e=>{this.successMessage=res.message,this.snackbarColor="red",this.showSnackbar=!0}).finally(()=>{this.localLoading=!1})):console.warn("Invalid item or invoice not open:",e)},onPayInvoiceConfirm(e){window.confirm("Are you sure you want to pay this invoice?")&&this.onPayInvoice(e)},confirmMarkPaid(e){confirm("Change invoice status to Paid?")&&(this.localLoading=!0,this.$store.dispatch("updateInvoiceStatus",{invoice_id:e.id}).then(e=>{this.successMessage=e.message,this.snackbarColor="green",this.showSnackbar=!0,this.dateRangeSelect()}).catch(()=>{this.successMessage="Failed to update invoice status",this.snackbarColor="red",this.showSnackbar=!0}).finally(()=>{this.localLoading=!1}))},showSnackbarMessage(e,t="green"){this.successMessage=e,this.snackbarColor=t,this.showSnackbar=!0},dateRangeSelect:async function(){this.$data.date_range_selected=this.dayToRange(this.$data.date_range_selected[0],this.$data.interval_selected_id),await Promise.all([this.$store.dispatch("fetchInvoices",{period_date_from:this.$data.date_range_selected[0],period_date_to:this.$data.date_range_selected[1]}),this.$store.dispatch("fetchStripeInvoicesData",{start_date:this.$data.date_range_selected[0],end_date:this.$data.date_range_selected[1]})])},onSelectInterval:function(){if(this.$data.interval_selected_id==p.e||this.$data.interval_selected_id==p.d||this.$data.interval_selected_id==p.c){let e=i()(this.$data.date_range_selected[0],"YYYY-MM-DD");this.$data.date_range_selected=[e.startOf("isoWeek").format("YYYY-MM-DD"),null]}if(this.$data.interval_selected_id==p.b){let e=i()();this.$data.date_range_selected=[e.format("YYYY-MM-DD"),null]}n.a.nextTick(()=>{this.dateRangeSelect()})},onPreviosRange:function(){let e=i()(this.$data.date_range_selected[0],"YYYY-MM-DD");switch(this.$data.interval_selected_id){case p.b:e.subtract(1,"day");break;case p.e:e.subtract(1,"weeks");break;case p.d:e.subtract(2,"weeks");break;case p.c:e.subtract(1,"months")}this.$data.date_range_selected=[e.format("YYYY-MM-DD"),null],this.dateRangeSelect()},onNextRange:function(){let e=i()(this.$data.date_range_selected[0],"YYYY-MM-DD");switch(this.$data.interval_selected_id){case p.b:e.add(1,"days");break;case p.e:e.add(1,"weeks");break;case p.d:e.add(2,"weeks");break;case p.c:e.add(1,"months")}this.$data.date_range_selected=[e.format("YYYY-MM-DD"),null],this.dateRangeSelect()},getAreaLabel:function(e){let t=o.find(this.restaurant_list,t=>+t.id==+e);if(!t)return"-";let a=o.find(this.area_list,e=>+e.id==+t.area_id);return a?a.name:"-"},dayToRange:function(e,t){return p.a.dayToRange(e,t)},dateRangeText:function(e){return p.a.dateRangeText(e)},getPeriodDateText:function(e){return i()(e,"YYYY-MM-DD").format("DD/MM/YYYY")},getRestaurantNameByID:function(e){let t=o.find(this.restaurant_list,t=>+e==+t.id);return t?t.name:"-"},markAsPaid:function(e){this.localLoading=!0,this.$store.dispatch("markAsPaid",{invoice_id:e.id,invoice_number:e.invoice_number,mark_as_paid:e.mark_as_paid}).then(()=>{this.$set(e,"mark_as_paid",1),this.dateRangeSelect(),console.log("success",response)}).catch(()=>{console.log("Failed, please try again")}).finally(()=>{this.localLoading=!1})},onDownloadInvoice:function(e){this.localLoading=!0,this.$store.dispatch("downloadInvoice",{invoice_number:e.invoice_number,mark_as_paid:e.mark_as_paid}).then(()=>{}).finally(()=>{this.localLoading=!1})},onViewInvoice:function(e){this.localLoading=!0,this.$store.dispatch("viewInvoice",{invoice_number:e.invoice_number,mark_as_paid:e.mark_as_paid}).then(()=>{}).finally(()=>{this.localLoading=!1})},onRemoveInvoice:function(e){this.localLoading=!0,this.$store.dispatch("removeInvoice",e).then(()=>{}).catch(e=>{e&&e.response&&e.response.data&&e.response.data.id&&alert(e.response.data.id[0])}).finally(()=>{this.localLoading=!1})}},filters:{headerDate:function(e){return i()(e,"YYYY-MM-DD").format("DD/MM/YYYY")}}},u=(a("17f2"),a("eaf2"),a("2877")),_=a("6544"),m=a.n(_),h=a("40dc"),g=a("c6a6"),f=a("8336"),b=a("b0af"),S=a("62ad"),x=a("2e4b"),k=a("ce7e"),y=a("132d"),C=a("e449"),D=a("0fd9"),w=a("b974"),T=a("2db4"),R=a("2fa4"),A=Object(u.a)(v,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-row",{attrs:{"no-gutters":""}},[a("v-col",[a("v-card",{staticStyle:{"margin-bottom":"6px"},attrs:{color:"grey lighten-4",flat:"",tile:""}},[a("v-app-bar",{staticStyle:{"margin-top":"70px"},attrs:{dense:"",fixed:"",color:"elevation-1"}},[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"d-flex pa-0"},[a("v-autocomplete",{staticStyle:{"max-width":"340px"},attrs:{items:e.locations_list,"item-text":"name","item-value":"_guid",label:"All locations",dense:"",solo:"",clearable:"","hide-details":""},scopedSlots:e._u([{key:"selection",fn:function(t){return[a("div",[a("div",{domProps:{innerHTML:e._s(t.item.name)}})])]}},{key:"item",fn:function(t){return[t.item._guid.type==e.TYPE_AREA?[a("div",{staticClass:"select-drop-item-group__area"},[a("div",{domProps:{innerHTML:e._s(t.item.name)}})])]:[a("div",{staticClass:"select-drop-item-sub_restaurant"},[a("div",{domProps:{innerHTML:e._s(t.item.name)}})])]]}}]),model:{value:e.location_selected,callback:function(t){e.location_selected=t},expression:"location_selected"}}),a("div",{staticStyle:{"margin-left":"16px"}},[a("v-btn",{on:{click:e.onPreviosRange}},[a("v-icon",[e._v("mdi-menu-left")])],1),a("v-menu",{attrs:{transition:"scale-transition","close-on-content-click":!1,"nudge-width":200,"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-btn",e._g({},s),[e._v("\n                    "+e._s(e.dateRangeText(e.date_range_selected))+"\n                  ")])]}}]),model:{value:e.menu_date_picker,callback:function(t){e.menu_date_picker=t},expression:"menu_date_picker"}},[a("v-card",{attrs:{"max-width":"346px"}},[a("v-date-picker",{attrs:{scrollable:"",actions:"","full-width":"","first-day-of-week":"1",range:"","title-date-format":e.dateRangeText},on:{"click:date":e.dateRangeSelect},model:{value:e.date_range_selected,callback:function(t){e.date_range_selected=t},expression:"date_range_selected"}}),a("v-divider")],1)],1),a("v-btn",{on:{click:e.onNextRange}},[a("v-icon",[e._v("mdi-menu-right")])],1)],1),a("v-select",{staticStyle:{"max-width":"150px","margin-left":"16px"},attrs:{items:e.interval_list,"item-text":"name","item-value":"id",dense:"",solo:"","hide-details":""},on:{change:e.onSelectInterval},model:{value:e.interval_selected_id,callback:function(t){e.interval_selected_id=t},expression:"interval_selected_id"}})],1)],1),a("v-spacer"),a("div",[a("request-invoice-modal",{attrs:{periodDateFrom:e.date_range_selected&&e.date_range_selected[0],periodDateTo:e.date_range_selected&&e.date_range_selected[1],restaurantId:e.location_selected&&e.location_selected.type==e.TYPE_RESTAURANT?e.location_selected.id:void 0,driverId:void 0,disabled:!e.date_range_selected||!e.location_selected||e.location_selected.type!=e.TYPE_RESTAURANT,comission:e.invoice_comission},on:{invoiceGenerated:e.dateRangeSelect}})],1)],1)],1),a("div",{staticClass:"d-flex mb-auto",attrs:{flat:"",tile:""}},[a("v-card",{staticClass:"panel-invoices",attrs:{color:"elevation-0"}},[a("v-card",{staticClass:"time-sheet-table",staticStyle:{"margin-bottom":"3px"},attrs:{color:"elevation-1",width:"100%",tile:""}},[a("v-card",{staticClass:"time-sheet-table__header",staticStyle:{"margin-bottom":"2px"},attrs:{color:"elevation-1",tile:""}},[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{sm:"2"}},[e._v("Period")]),a("v-col",{attrs:{sm:"1"}},[e._v("Invoice Reference")]),a("v-col",{attrs:{sm:"1"}},[e._v("Amount")]),a("v-col",{attrs:{sm:"2"},on:{click:function(t){e.sortLocationAsc=!e.sortLocationAsc}}},[e._v("Location "),a("v-icon",{attrs:{small:""}},[e._v(e._s(e.sortLocationAsc?"mdi-arrow-up":"mdi-arrow-down"))])],1),a("v-col",{attrs:{sm:"1"}},[e._v("Status")])],1)],1),e._l(e.invoicesSeached,(function(t){return a("v-card",{key:t.id,staticClass:"time-sheet-table__line",staticStyle:{"border-bottom":"1px solid #9ea2a9","padding-bottom":"3px","margin-bottom":"1px"},attrs:{color:"elevation-1","no-gutters":"",tile:""}},[a("v-row",{attrs:{align:"center"}},[a("v-col",{attrs:{sm:"2"}},[e._v(e._s(e.moment(t.period_date_from).format("DD/MM"))+" to "+e._s(e.moment(t.period_date_to).format("DD/MM/YYYY")))]),a("v-col",{attrs:{sm:"1"}},[a("a",{staticStyle:{"text-decoration":"none",color:"inherit"},attrs:{href:e.config.freeagent_base_url+"invoices/"+t.invoice_number,target:"_blank"}},[e._v(e._s(t.freeagent_invoice.reference))])]),a("v-col",{attrs:{sm:"1"}},[e._v("£"+e._s(t.freeagent_invoice?parseFloat(t.freeagent_invoice.total_value||0).toFixed(2):"0.00"))]),a("v-col",{attrs:{sm:"2"}},[e._v(e._s(e.getRestaurantNameByID(t.restaurant_id))+", "+e._s(e.getAreaLabel(t.restaurant_id)))]),a("v-col",{attrs:{sm:"1"}},[t?a("span",{staticClass:"invoice-status",class:{"status-paid":1===t.payment_status,"status-pending":0===t.payment_status},on:{click:function(a){0===t.payment_status&&e.confirmMarkPaid(t)}}},[e._v(e._s(1===t.payment_status?"Paid":"Pending"))]):e._e()]),a("v-col",{staticClass:"text-left",attrs:{sm:"5"}},[t?a("div",{staticClass:"d-flex justify-start",staticStyle:{gap:"8px","flex-wrap":"wrap"}},[a("v-btn",{attrs:{small:"",color:"green",disabled:1===t.payment_status||e.localLoading,loading:e.localLoading},on:{click:function(a){return e.onPayInvoiceConfirm(t)}}},[a("v-icon",[e._v("mdi-credit-card")]),e._v(" \n                  Pay Now\n                ")],1),a("v-btn",{attrs:{small:"",loading:e.localLoading},on:{click:function(a){return e.onViewInvoice(t)}}},[a("v-icon",[e._v("mdi-file-eye")]),e._v(" View\n                ")],1),a("v-btn",{staticClass:"ml-2",attrs:{small:"",loading:e.localLoading},on:{click:function(a){return e.onDownloadInvoice(t)}}},[a("v-icon",[e._v("mdi-file-download")]),e._v(" Download\n                ")],1),a("v-btn",{staticClass:"ml-2",attrs:{small:"",disabled:1===t.mark_as_paid,loading:e.localLoading},on:{click:function(a){return e.markAsPaid(t)}}},[a("v-icon",[e._v("mdi-file-check")]),e._v(" Mark as Paid\n                ")],1),a("v-btn",{staticClass:"red darken-4 ml-2",attrs:{small:"",disabled:e.localLoading,loading:e.localLoading},on:{click:function(a){return e.onRemoveInvoice(t)}}},[a("v-icon",[e._v("mdi-close-circle")]),e._v(" Remove\n              ")],1)],1):e._e()])],1)],1)}))],2)],1)],1)],1),a("v-snackbar",{staticClass:"payment-snackbar",attrs:{timeout:3e3,color:e.snackbarColor,transition:"slide-y-transition",top:"",right:"","multi-line":!0},scopedSlots:e._u([{key:"action",fn:function(t){var s=t.attrs;return[a("v-btn",e._b({attrs:{color:"white",text:"",small:""},on:{click:function(t){e.showSnackbar=!1}}},"v-btn",s,!1),[a("v-icon",{attrs:{small:""}},[e._v("mdi-close")])],1)]}}]),model:{value:e.showSnackbar,callback:function(t){e.showSnackbar=t},expression:"showSnackbar"}},[a("div",{staticClass:"d-flex align-center"},[a("v-icon",{staticClass:"mr-2",attrs:{color:(e.snackbarColor,"white")}},[e._v("\n          "+e._s("green"===e.snackbarColor?"mdi-check-circle":"mdi-alert-circle")+"\n        ")]),a("span",{staticClass:"snackbar-text"},[e._v(e._s(e.successMessage))])],1)])],1)}),[],!1,null,"a0e20e72",null);t.a=A.exports;m()(A,{VAppBar:h.a,VAutocomplete:g.a,VBtn:f.a,VCard:b.a,VCol:S.a,VDatePicker:x.a,VDivider:k.a,VIcon:y.a,VMenu:C.a,VRow:D.a,VSelect:w.a,VSnackbar:T.a,VSpacer:R.a})},"17f2":function(e,t,a){"use strict";a("8ca9")},"2a5a":function(e,t,a){"use strict";a("ab29")},"2d0b":function(e,t,a){"use strict";var s=a("2f62"),i=a("c1df"),n=a.n(i),o=a("55c2"),l={name:"NewsFeed",data:()=>({dialog:!1,postsList:[],localLoading:!1,STATUS_SHOW:o.f,STATUS_HIDE:o.e,PINNED_YES:o.d,PINNED_NO:o.c,IMPORTANT_YES:o.b,IMPORTANT_DEFAULT:o.a,page:1,per_page:15,per_page_list:[10,15,50,100,1e3]}),created(){this.$store.dispatch("fetchPosts"),this.$store.dispatch("fetchAreas"),this.$store.dispatch("fetchDrivers"),this.$store.dispatch("fetchRestaurants")},computed:{...Object(s.c)(["posts","areas","restaurants","drivers"]),postList(){return this.posts},postsSearchedPaged(){let e=this.per_page*(this.page-1),t=e+this.per_page;return this.postList.slice(e,t)},total_pages(){return Math.ceil(this.postList.length/this.per_page)}},methods:{editPost(e){Object.keys(this.posts).forEach(t=>{this.posts[t].id===e.id&&(this.posts[t].postTitle=e.postTitle,this.posts[t].postContent=e.postContent)})},deleteItem(e){confirm("Remove news "+e.postTitle+"?")&&(this.localLoading=!0,this.$store.dispatch("deletePost",e).then(()=>{}).catch(e=>{e&&e.response&&e.response.data&&e.response.data.id&&alert(e.response.data.id[0])}).finally(()=>{this.localLoading=!1}))},onChangeStatus(e){this.localLoading=!0;let t=o.f;e.status==o.f&&(t=o.e),this.$store.dispatch("changeStatus",{id:e.id,status:t}).then(()=>{}).catch(e=>{e&&e.response&&e.response.data&&e.response.data.id&&alert(e.response.data.id[0])}).finally(()=>{this.localLoading=!1})},onChangePinned(e){this.localLoading=!0;let t=o.d;e.pinned==o.d&&(t=o.c),this.$store.dispatch("changePinned",{id:e.id,pinned:t}).then(()=>{}).catch(e=>{e&&e.response&&e.response.data&&e.response.data.id&&alert(e.response.data.id[0])}).finally(()=>{this.localLoading=!1})},onChangePage(e){this.page=e,window.scrollTo({top:0,behavior:"smooth"})},onCangePerPage(){this.page=1},mysqlTimestampToDate:e=>n.a.utc(e,"YYYY-MM-DD HH:mm:ss").local().format("DD/MM/YYYY HH:mm")}},r=(a("6138"),a("2877")),c=a("6544"),d=a.n(c),p=a("8336"),v=a("99d9"),u=a("cc20"),_=a("62ad"),m=a("a523"),h=a("cd55"),g=a("49e2"),f=a("c865"),b=a("0393"),S=a("0e8f"),x=a("132d"),k=a("adda"),y=a("a722"),C=a("891e"),D=a("0fd9"),w=a("b974"),T=a("2fa4"),R=a("3a2f"),A=Object(r.a)(l,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("div",[a("v-flex",[a("v-row",[a("h1",{staticClass:"page-title"},[e._v("News Feed")]),a("v-spacer",{staticClass:"line"}),a("hr"),a("new-post-modal",{attrs:{postsList:e.postsList}})],1)],1),a("v-flex",{staticClass:"mt-3"},[a("v-layout",{attrs:{row:""}},[a("v-expansion-panels",e._l(e.postsSearchedPaged,(function(t){return a("v-expansion-panel",{key:t.id,staticClass:"col-sm-12 mb-2",attrs:{disabled:e.localLoading}},[a("div",{staticClass:"post-actions float-right flex-column d-flex pl-2"},[a("edit-post-modal",{attrs:{thisPostData:t,editPost:e.editPost}}),a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(s){var i=s.on;return[a("v-btn",e._g({attrs:{"x-small":"",icon:"",color:"grey lighten-1"},on:{click:function(a){return e.deleteItem(t)}}},i),[a("v-icon",{staticStyle:{"font-size":"20px"}},[e._v("mdi-delete")])],1)]}}],null,!0)},[a("span",[e._v("Delete")])]),a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(s){var i=s.on;return[a("v-btn",e._g({attrs:{"x-small":"",icon:"",color:"grey lighten-1"},on:{click:function(a){return e.onChangeStatus(t)}}},i),[t.status==e.STATUS_SHOW?a("v-icon",{staticStyle:{"font-size":"20px"}},[e._v("mdi-eye")]):e._e(),t.status==e.STATUS_HIDE?a("v-icon",{staticStyle:{"font-size":"20px",color:"red"}},[e._v("mdi-eye-off")]):e._e()],1)]}}],null,!0)},[t.status==e.STATUS_SHOW?a("span",[e._v("Press to Hide")]):e._e(),t.status==e.STATUS_HIDE?a("span",[e._v("Press to Show")]):e._e()]),a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(s){var i=s.on;return[a("v-btn",e._g({attrs:{"x-small":"",icon:"",color:"grey lighten-1"},on:{click:function(a){return e.onChangePinned(t)}}},i),[t.pinned==e.PINNED_YES?a("v-icon",{staticStyle:{"font-size":"20px",color:"blue"}},[e._v("mdi-pin")]):e._e(),t.pinned==e.PINNED_NO?a("v-icon",{staticStyle:{"font-size":"20px"}},[e._v("mdi-pin-off")]):e._e()],1)]}}],null,!0)},[t.pinned==e.PINNED_YES?a("span",[e._v("Press to Pinout")]):e._e(),t.pinned==e.PINNED_NO?a("span",[e._v("Press to Pin")]):e._e()])],1),a("v-card-text",{staticClass:"overline text-right mb-0 pb-0"},[a("span",{staticClass:"pr-2"},[t.important==e.IMPORTANT_YES?a("v-chip",{attrs:{color:"red","text-color":"white","x-small":""}},[e._v("Important!\n                            ")]):e._e()],1),a("span",{staticClass:"pr-2"},[e._v("("+e._s(t.readedCount)+" / "+e._s(t.totalReadersCount)+" read)")]),a("span",{staticClass:"pr-2"},[e._v(e._s(e.mysqlTimestampToDate(t.updated_at)))])]),a("v-card-text",{staticClass:"overline text-right mb-0 pb-0"},[a("span",{staticClass:"pr-2"},[e._v("\n                                Created By: "+e._s(t.news_author)+"\n                            ")])]),null!==t.img?a("v-img",{attrs:{"max-width":"500px","max-height":"300px",src:e.appConfig.app_url+"/images/"+t.img}}):e._e(),a("v-card-title",{staticClass:"pt-0"},[e._v(e._s(t.postTitle))]),a("v-card-text",{staticClass:"post-content",domProps:{innerHTML:e._s(t.postContent)}}),a("v-card-actions",{staticClass:"justify-end"},[a("v-expansion-panel-header",{scopedSlots:e._u([{key:"actions",fn:function(){return[a("v-icon")]},proxy:!0}],null,!0)},[a("v-btn",{attrs:{small:"",text:"",color:"primary"}},[e._v("View Replies\n                                ")])],1),a("new-reply-modal",{attrs:{thisPostData:t}})],1),a("v-expansion-panel-content",e._l(t.replies,(function(t){return a("div",{key:t.id},[a("v-card-text",{staticClass:"overline text-right mb-0 pb-0"},[a("span",[e._v("\n                                        >by "+e._s(t.reply_author)+"\n                                    ")])]),a("v-card-text",[e._v(e._s(t.reply_content))])],1)})),0)],1)})),1)],1)],1),a("v-row",[a("v-col",{attrs:{cols:"12",sm:"2",md:"2"}},[a("v-flex",{staticClass:"d-flex flex-row"},[a("div",{staticClass:"pt-2",staticStyle:{"min-width":"75px"}},[e._v("\n                        Per page:\n                    ")]),a("v-select",{attrs:{items:e.per_page_list,label:"Solo field",solo:"",dense:"","hide-details":""},on:{change:e.onCangePerPage},model:{value:e.per_page,callback:function(t){e.per_page=t},expression:"per_page"}})],1)],1),a("v-col",{attrs:{cols:"12",sm:"8",md:"8"}},[a("v-pagination",{attrs:{value:e.page,length:e.total_pages,"total-visible":10},on:{input:e.onChangePage}})],1),a("v-col",{attrs:{cols:"12",sm:"2",md:"2"}},[e._v("\n                "+e._s((e.page-1)*e.per_page+1)+" - "+e._s(e.page*e.per_page<e.postList.length?e.page*e.per_page:e.postList.length)+" of "+e._s(e.postList.length)+"\n            ")])],1)],1)])}),[],!1,null,"27abf2a7",null);t.a=A.exports;d()(A,{VBtn:p.a,VCardActions:v.a,VCardText:v.b,VCardTitle:v.c,VChip:u.a,VCol:_.a,VContainer:m.a,VExpansionPanel:h.a,VExpansionPanelContent:g.a,VExpansionPanelHeader:f.a,VExpansionPanels:b.a,VFlex:S.a,VIcon:x.a,VImg:k.a,VLayout:y.a,VPagination:C.a,VRow:D.a,VSelect:w.a,VSpacer:T.a,VTooltip:R.a})},5046:function(e,t,a){"use strict";var s=a("c1df"),i=a.n(s),n=a("2b0e"),o=a("2ef0"),l=a("2f62"),r=a("156f"),c=a("1168"),d={name:"Invoices",data:()=>({TYPE_AREA:r.b,TYPE_RESTAURANT:r.c,interval_list:[{id:c.b,name:"Day",$isDisabled:!0},{id:c.e,name:"Week"},{id:c.d,name:"2-Week"},{id:c.c,name:"Month"}],localLoading:!1,date_range_selected:null,period_date_selected:null,menu_date_picker:!1,location_selected:void 0,interval_selected_id:c.e,area_list:[{name:"All restaurants",type:r.b,_guid:{type:r.b}}],restaurant_list:[],is_mobile_version:!1,restaurant_id_mobile_selected:void 0,restaurant_item_mobile_selected:void 0}),created(){let e=!1;var t;t=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0),this.is_mobile_version=e},computed:{...Object(l.c)({invoices_list:"invoices"}),locations_list(){let e=[];return e.push(this.area_list[0]),o.each(this.restaurant_list,t=>{t._guid={id:t.id,type:r.c},e.push(t)}),e},restaurantListSearched(){if(!this.$data.location_selected)return this.restaurant_list;if(this.$data.location_selected.type==r.c){let e=o.find(this.restaurant_list,e=>e.id==this.$data.location_selected.id);return e?[e]:[]}return this.restaurant_list},invoicesSeached(){let e=this.invoices_list;if(void 0!==this.$data.location_selected){let t=o.map(this.restaurantListSearched,e=>+e.id);e=o.filter(e,e=>-1!==t.indexOf(+e.restaurant_id))}return e=o.orderBy(e,e=>e.period_date_from),e}},watch:{period_date:function(e){this.$data.period_date_selected!=e&&(this.$data.period_date_selected=e)}},mounted(){let e=i()();this.$data.date_range_selected=[e.startOf("isoWeek").format("YYYY-MM-DD"),null],this.dateRangeSelect();let t=JSON.parse(localStorage.getItem("user")),a=[];o.each(t.restaurants,e=>{a.push({id:e.id,name:e.name,contact_name:e.contact_name,email:t.email,type:r.c})}),this.restaurant_list=a,!this.restaurant_item_mobile_selected&&this.restaurantListSearched.length>0&&(this.restaurant_id_mobile_selected=this.restaurantListSearched[0].id,this.onSelectRestaurantMobile(this.restaurant_id_mobile_selected))},methods:{dateRangeSelect:async function(){this.$data.date_range_selected=this.dayToRange(this.$data.date_range_selected[0],this.$data.interval_selected_id),await Promise.all([this.$store.dispatch("fetchInvoices",{period_date_from:this.$data.date_range_selected[0],period_date_to:this.$data.date_range_selected[1]})])},onSelectInterval:function(){if(this.$data.interval_selected_id==c.e||this.$data.interval_selected_id==c.d||this.$data.interval_selected_id==c.c){let e=i()(this.$data.date_range_selected[0],"YYYY-MM-DD");this.$data.date_range_selected=[e.startOf("isoWeek").format("YYYY-MM-DD"),null]}if(this.$data.interval_selected_id==c.b){let e=i()();this.$data.date_range_selected=[e.format("YYYY-MM-DD"),null]}n.a.nextTick(()=>{this.dateRangeSelect()})},onSelectRestaurantMobile:function(e){this.restaurant_item_mobile_selected=o.find(this.restaurantListSearched,t=>t.id==e)},onPreviosRange:function(){let e=i()(this.$data.date_range_selected[0],"YYYY-MM-DD");switch(this.$data.interval_selected_id){case c.b:e.subtract(1,"day");break;case c.e:e.subtract(1,"weeks");break;case c.d:e.subtract(2,"weeks");break;case c.c:e.subtract(1,"months")}this.$data.date_range_selected=[e.format("YYYY-MM-DD"),null],this.dateRangeSelect()},onNextRange:function(){let e=i()(this.$data.date_range_selected[0],"YYYY-MM-DD");switch(this.$data.interval_selected_id){case c.b:e.add(1,"days");break;case c.e:e.add(1,"weeks");break;case c.d:e.add(2,"weeks");break;case c.c:e.add(1,"months")}this.$data.date_range_selected=[e.format("YYYY-MM-DD"),null],this.dateRangeSelect()},getAreaLabel:function(e){let t=o.find(this.restaurant_list,t=>+t.id==+e);if(!t)return"-";let a=o.find(this.area_list,e=>+e.id==+t.area_id);return a?a.name:"-"},dayToRange:function(e,t){return c.a.dayToRange(e,t)},dateRangeText:function(e){return c.a.dateRangeText(e)},getPeriodDateText:function(e){return i()(e,"YYYY-MM-DD").format("DD/MM/YYYY")},getRestaurantNameByID:function(e){let t=o.find(this.restaurant_list,t=>+e==+t.id);return t?t.name:"-"},onDownloadInvocie:function(e){this.localLoading=!0,this.$store.dispatch("downloadInvoice",{id:e.id,invoice_number:e.invoice_number,period_date_from:e.period_date_from,period_date_to:e.period_date_to}).then(()=>{}).finally(()=>{this.localLoading=!1})},onViewInvocie:function(e){this.localLoading=!0,this.$store.dispatch("viewInvocie",{id:e.id}).then(()=>{}).finally(()=>{this.localLoading=!1})}},filters:{headerDate:function(e){return i()(e,"YYYY-MM-DD").format("DD/MM/YYYY")}}},p=(a("2a5a"),a("ef72"),a("2877")),v=a("6544"),u=a.n(v),_=a("40dc"),m=a("c6a6"),h=a("8336"),g=a("b0af"),f=a("62ad"),b=a("2e4b"),S=a("ce7e"),x=a("132d"),k=a("e449"),y=a("0fd9"),C=a("b974"),D=a("2fa4"),w=a("71d9"),T=Object(p.a)(d,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-row",{attrs:{"no-gutters":""}},[e.is_mobile_version?e._e():a("v-col",[a("v-card",{staticStyle:{"margin-bottom":"6px"},attrs:{color:"grey lighten-4",flat:"",tile:""}},[a("v-app-bar",{staticStyle:{"margin-top":"70px"},attrs:{dense:"",fixed:"",color:"elevation-1"}},[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"d-flex pa-0"},[a("v-autocomplete",{staticStyle:{"max-width":"340px"},attrs:{items:e.locations_list,"item-text":"name","item-value":"_guid",label:"All locations",dense:"",solo:"",clearable:"","hide-details":""},scopedSlots:e._u([{key:"selection",fn:function(t){return[a("div",[a("div",{domProps:{innerHTML:e._s(t.item.name)}})])]}},{key:"item",fn:function(t){return[t.item._guid.type==e.TYPE_AREA?[a("div",{staticClass:"select-drop-item-group__area"},[a("div",{domProps:{innerHTML:e._s(t.item.name)}})])]:[a("div",{staticClass:"select-drop-item-sub_restaurant"},[a("div",{domProps:{innerHTML:e._s(t.item.name)}})])]]}}],null,!1,1090052647),model:{value:e.location_selected,callback:function(t){e.location_selected=t},expression:"location_selected"}}),a("div",{staticStyle:{"margin-left":"16px"}},[a("v-btn",{on:{click:e.onPreviosRange}},[a("v-icon",[e._v("mdi-menu-left")])],1),a("v-menu",{attrs:{transition:"scale-transition","close-on-content-click":!1,"nudge-width":200,"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-btn",e._g({},s),[e._v("\n                    "+e._s(e.dateRangeText(e.date_range_selected))+"\n                  ")])]}}],null,!1,1263868741),model:{value:e.menu_date_picker,callback:function(t){e.menu_date_picker=t},expression:"menu_date_picker"}},[a("v-card",{attrs:{"max-width":"346px"}},[a("v-date-picker",{attrs:{scrollable:"",actions:"","full-width":"","first-day-of-week":"1",range:"","title-date-format":e.dateRangeText},on:{"click:date":e.dateRangeSelect},model:{value:e.date_range_selected,callback:function(t){e.date_range_selected=t},expression:"date_range_selected"}}),a("v-divider")],1)],1),a("v-btn",{on:{click:e.onNextRange}},[a("v-icon",[e._v("mdi-menu-right")])],1)],1),a("v-select",{staticStyle:{"max-width":"150px","margin-left":"16px"},attrs:{items:e.interval_list,"item-text":"name","item-value":"id",dense:"",solo:"","hide-details":""},on:{change:e.onSelectInterval},model:{value:e.interval_selected_id,callback:function(t){e.interval_selected_id=t},expression:"interval_selected_id"}})],1)],1),a("v-spacer"),a("div")],1)],1),a("div",{staticClass:"d-flex mb-auto",attrs:{flat:"",tile:""}},[a("v-card",{staticClass:"panel-invoices",attrs:{color:"elevation-0"}},[a("v-card",{staticClass:"time-sheet-table",staticStyle:{"margin-bottom":"3px"},attrs:{color:"elevation-1",width:"100%",tile:""}},[a("v-card",{staticClass:"time-sheet-table__header",staticStyle:{"margin-bottom":"2px"},attrs:{color:"elevation-1",tile:""}},[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",[e._v("Period")]),a("v-col",[e._v("Number")]),a("v-col",[e._v("Location")]),a("v-col",[e._v("Сommission")]),a("v-col")],1)],1),e._l(e.invoicesSeached,(function(t){return a("v-card",{key:t.id,staticClass:"time-sheet-table__line",staticStyle:{"margin-bottom":"1px"},attrs:{color:"elevation-1","no-gutters":"",tile:""}},[a("v-row",{attrs:{align:"stretch"}},[a("v-col",[e._v(e._s(e._f("headerDate")(t.period_date_from))+" to "+e._s(e._f("headerDate")(t.period_date_to)))]),a("v-col",[e._v(e._s(t.invoice_number))]),a("v-col",[e._v(e._s(e.getRestaurantNameByID(t.restaurant_id))+", "+e._s(e.getAreaLabel(t.restaurant_id)))]),a("v-col",[e._v("\n                "+e._s(t.comission)+"\n              ")]),a("v-col",[a("v-btn",{attrs:{loading:e.localLoading},on:{click:function(a){return e.onViewInvocie(t)}}},[a("v-icon",[e._v("mdi-file-document-outline")]),e._v(" View\n                ")],1),a("v-btn",{staticClass:"ml-2",attrs:{disabled:e.localLoading,loading:e.localLoading},on:{click:function(a){return e.onDownloadInvocie(t)}}},[a("v-icon",[e._v("mdi-file-document-outline")]),e._v(" Download\n                ")],1)],1)],1)],1)}))],2)],1)],1)],1),e.is_mobile_version?a("v-col",[a("v-card",{staticStyle:{"margin-bottom":"6px"},attrs:{color:"grey lighten-4",flat:"",tile:""}},[a("v-toolbar",{attrs:{dense:"",color:"elevation-1 tool-bar__actions-panel header-btn-panel header-btn-panel-mobile"}},[a("v-row",{staticClass:"d-flex mb-auto"},[a("div",{staticClass:"menu-date__picker-mobile"},[a("v-btn",{on:{click:e.onPreviosRange}},[a("v-icon",[e._v("mdi-menu-left")])],1),a("v-menu",{attrs:{transition:"scale-transition","close-on-content-click":!1,"nudge-width":200,"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-btn",e._g({},s),[e._v("\n                  "+e._s(e.dateRangeText(e.date_range_selected))+"\n                ")])]}}],null,!1,3587149381),model:{value:e.menu_date_picker,callback:function(t){e.menu_date_picker=t},expression:"menu_date_picker"}},[a("v-card",{attrs:{"max-width":"346px"}},[a("v-date-picker",{attrs:{scrollable:"",actions:"","full-width":"","first-day-of-week":"1",range:"","title-date-format":e.dateRangeText},on:{"click:date":e.dateRangeSelect},model:{value:e.date_range_selected,callback:function(t){e.date_range_selected=t},expression:"date_range_selected"}}),a("v-divider")],1)],1),a("v-btn",{on:{click:e.onNextRange}},[a("v-icon",[e._v("mdi-menu-right")])],1)],1),a("div",{staticClass:"menu-interval-changer-mobile"},[a("v-select",{attrs:{items:e.interval_list,"item-text":"name","item-value":"id",dense:"",solo:"","hide-details":""},on:{change:e.onSelectInterval},model:{value:e.interval_selected_id,callback:function(t){e.interval_selected_id=t},expression:"interval_selected_id"}})],1),a("div",{staticClass:"menu-restaurant-changer-mobile"},[a("v-select",{attrs:{items:e.restaurantListSearched,"item-text":"name","item-value":"id",dense:"",solo:"","hide-details":""},on:{change:e.onSelectRestaurantMobile},model:{value:e.restaurant_id_mobile_selected,callback:function(t){e.restaurant_id_mobile_selected=t},expression:"restaurant_id_mobile_selected"}})],1)]),a("v-spacer")],1)],1),e._l(e.invoicesSeached,(function(t){return a("v-card",{key:t.id,staticClass:"time-sheet-table__line",staticStyle:{"margin-bottom":"2px"},attrs:{color:"elevation-1","no-gutters":"",tile:""}},[a("v-row",[a("v-col",[a("div",{staticClass:"light-green--text period_date__text-fix"},[e._v("\n            Period "+e._s(e._f("headerDate")(t.period_date_from))+" to "+e._s(e._f("headerDate")(t.period_date_to))+"\n          ")])])],1),a("v-row",[a("v-col",[a("v-row",[a("v-col",[a("b",[e._v("Number:")]),e._v(" "+e._s(t.invoice_number)),a("br"),a("b",[e._v("Сommission:")]),e._v(" "+e._s(t.comission)),a("br"),e._v("\n              "+e._s(e.getRestaurantNameByID(t.restaurant_id))+"\n            ")])],1)],1),a("v-col",[a("v-row",[a("v-col",[a("v-btn",{staticClass:"large-button__download-fix",attrs:{disabled:e.localLoading,loading:e.localLoading},on:{click:function(a){return e.onDownloadInvocie(t)}}},[a("v-row",[a("v-col",[a("v-icon",[e._v("mdi-file-document-outline")])],1)],1),a("v-row",[a("v-col",[e._v("\n                    Download\n                  ")])],1)],1)],1)],1)],1)],1)],1)}))],2):e._e()],1)}),[],!1,null,"36c9011e",null);t.a=T.exports;u()(T,{VAppBar:_.a,VAutocomplete:m.a,VBtn:h.a,VCard:g.a,VCol:f.a,VDatePicker:b.a,VDivider:S.a,VIcon:x.a,VMenu:k.a,VRow:y.a,VSelect:C.a,VSpacer:D.a,VToolbar:w.a})},6138:function(e,t,a){"use strict";a("dcac")},"65cf":function(e,t,a){},"8ca9":function(e,t,a){},"8cd4":function(e,t,a){"use strict";var s={name:"AddReplyModal",props:["thisPostData"],data:()=>({dialog:!1,postData:null,replyContent:"",valid:!1,localLoading:!1,replyContentRules:[e=>!!e||"Please enter Reply content"]}),computed:{user:()=>JSON.parse(localStorage.getItem("user"))},methods:{submit(){if(this.$refs.form.validate()){this.localLoading=!0;const e={reply_content:this.replyContent,new_id:this.thisPostData.id};this.$store.dispatch("createNewReply",e).then(()=>{}).finally(()=>{this.replyContent="",this.localLoading=!1,this.dialog=!1})}},cancel(){this.replyContent="",this.dialog=!1}}},i=a("2877"),n=a("6544"),o=a.n(n),l=a("8336"),r=a("b0af"),c=a("99d9"),d=a("62ad"),p=a("a523"),v=a("169a"),u=a("0e8f"),_=a("4bd4"),m=a("132d"),h=a("a722"),g=a("8654"),f=a("3a2f"),b=Object(i.a)(s,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-btn",e._g({staticClass:"primary",attrs:{small:"",text:""},on:{click:function(t){t.stopPropagation(),e.dialog=!0}}},s),[e._v("Reply\n            ")])]}}])},[a("span",[e._v("Reply")])]),a("v-dialog",{attrs:{width:"600px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e._v("Add Reply to News Feed")]),a("div",{staticClass:"dialog-closeBtn",on:{click:function(t){e.dialog=!1}}},[a("v-icon",{attrs:{left:""}},[e._v("mdi-close")])],1)]),a("v-card-text",[a("v-container",[a("v-form",{ref:"form",attrs:{validation:""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-col",{attrs:{cols:"12",sm:"12"}},[a("v-text-field",{attrs:{"clear-icon":"mdi-close",clearable:"",name:"Reply Content",label:"Reply Content*",outlined:"",rules:e.replyContentRules},model:{value:e.replyContent,callback:function(t){e.replyContent=t},expression:"replyContent"}})],1)],1)],1),a("div",{staticClass:"d-flex justify-center"},[a("v-btn",{staticClass:"mr-4",attrs:{color:"primary",depressed:"",disabled:!e.valid||e.localLoading,loading:e.localLoading},on:{click:e.submit}},[a("v-icon",{attrs:{left:""}},[e._v("mdi-publish")]),e._v("Publish")],1),a("v-btn",{attrs:{color:"warning",depressed:"",loading:e.localLoading},on:{click:e.cancel}},[a("v-icon",{attrs:{left:""}},[e._v("mdi-cancel")]),e._v("Clear")],1)],1)],1)],1)],1)],1)],1)],1)}),[],!1,null,"4498cc64",null);t.a=b.exports;o()(b,{VBtn:l.a,VCard:r.a,VCardText:c.b,VCardTitle:c.c,VCol:d.a,VContainer:p.a,VDialog:v.a,VFlex:u.a,VForm:_.a,VIcon:m.a,VLayout:h.a,VTextField:g.a,VTooltip:f.a})},ab29:function(e,t,a){},c681:function(e,t,a){"use strict";var s=a("2b0e"),i=a("2f62"),n=a("3f38"),o=a("55c2");var l={name:"EditPostModal",components:{TiptapVuetify:n.c},props:["thisPostData","editPost"],data:()=>({checkbox:o.a,file:{},dialog:!1,postData:null,ADDRESS_TO_ALL:10,ADDRESS_TO_AREAS:20,ADDRESS_TO_RESTAURANTS:30,ADDRESS_TO_DRIVERS:40,postTitle:"",postContent:"",postContentDirty:!1,addresseeSelect:10,addresseeList:[{id:10,value:"All"},{id:20,value:"Selected Areas"},{id:30,value:"Selected Restaurants"},{id:40,value:"Selected Driver(s)"}],areasSelected:[],restaurantsSelected:[],driversSelected:[],id:"",creationDate:null,addressee:null,valid:!1,localLoading:!1,postTitleRules:[e=>!!e||"Please enter post title"],postContentRules:[e=>!!e||"Please enter post content"],restaurantSelectRules:[e=>!!e||"Please select a restaurant"],areaSelectRules:[e=>!!e||"Please select an area"],driverSelectRules:[e=>!!e||"Please select (a) driver(s)"],imgRules:[e=>!(e&&e.size>1e7)||"File size should be less than 10 MB!"],extensions:[n.e,n.b,n.a],IMPORTANT_YES:o.b,IMPORTANT_DEFAULT:o.a}),created(){this.postData=this.thisPostData,this.postTitle=this.postData.postTitle,this.addresseeSelect=10,10==this.postData.for_areas&&(this.addresseeSelect=20),10==this.postData.for_restaurants&&(this.addresseeSelect=30),10==this.postData.for_drivers&&(this.addresseeSelect=40),this.areasSelected=_.map(this.postData.news_feed_areas,e=>+e.area_id),this.restaurantsSelected=_.map(this.postData.news_feed_restaurants,e=>+e.restaurant_id),this.driversSelected=_.map(this.postData.news_feed_drivers,e=>+e.driver_id),this.checkbox=+this.postData.important,this.postContent=this.postData.postContent,this.id=this.postData.id,this.creationDate=this.postData.creationDate,this.addressee=this.postData.addressee,this.postImg=this.postData.img},computed:{...Object(i.c)(["restaurants","areas","drivers"]),areasList(){return this.areas},restaurantsList(){return this.restaurants},driversList(){return this.drivers},isPostContentValid(){return!!this.postContent&&"<p></p>"!=this.postContent}},methods:{onChangeFileUpload(e){this.file=e},resetAddresseeData(){this.areasSelected=[],this.restaurantsSelected=[],this.driversSelected=[]},setAreaAsAddressee(){},setRestaurantAsAddressee(){},setDriverAsAddressee(){},postContentModifed(){s.a.nextTick(()=>{"<p></p>"==this.postContent&&(this.postContent="")}),this.postContentDirty=!0},submit(){if(this.$refs.form.validate()){this.localLoading=!0;let e=new FormData;e.append("file",this.file),e.append("postTitle",this.postTitle),e.append("postContent",this.postContent),_.isEmpty(this.areasSelected)||e.append("areas",JSON.stringify(this.areasSelected)),_.isEmpty(this.restaurantsSelected)||e.append("restaurants",JSON.stringify(this.restaurantsSelected)),_.isEmpty(this.driversSelected)||e.append("drivers",JSON.stringify(this.driversSelected)),e.append("id",this.id),e.append("important",this.checkbox),this.$store.dispatch("editPost",e).then(()=>{this.dialog=!1}).finally(()=>{this.localLoading=!1})}},cancel(){this.dialog=!1,this.postData=this.thisPostData,this.postTitle=this.postData.postTitle,this.checkbox=this.postData.important,this.postContent=this.postData.postContent,this.postContentDirty=!1,this.dialog=!1}}},r=a("2877"),c=a("6544"),d=a.n(c),p=a("c6a6"),v=a("8336"),u=a("b0af"),m=a("99d9"),h=a("ac7c"),g=a("62ad"),f=a("a523"),b=a("169a"),S=a("23a7"),x=a("0e8f"),k=a("4bd4"),y=a("132d"),C=a("adda"),D=a("a722"),w=a("b974"),T=a("8654"),R=a("3a2f"),A=Object(r.a)(l,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-btn",e._g({attrs:{"x-small":"",icon:"",color:"grey lighten-1"},on:{click:function(t){t.stopPropagation(),e.dialog=!0}}},s),[a("v-icon",{staticStyle:{"font-size":"20px"}},[e._v("mdi-pencil")])],1)]}}])},[a("span",[e._v("Edit")])]),a("v-dialog",{attrs:{width:"600px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e._v("Edit Post")]),a("div",{staticClass:"dialog-closeBtn",on:{click:function(t){e.dialog=!1}}},[a("v-icon",{attrs:{left:""}},[e._v("mdi-close")])],1)]),a("v-card-text",[a("v-container",{staticClass:"pl-0 pr-0"},[a("v-form",{ref:"form",attrs:{validation:""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-col",{staticClass:"area-select",attrs:{cols:"12",sm:"12"}},[a("v-select",{attrs:{outlined:"",label:"To*",required:"",items:e.addresseeList,"item-value":"id","item-text":"value"},on:{change:e.resetAddresseeData},model:{value:e.addresseeSelect,callback:function(t){e.addresseeSelect=t},expression:"addresseeSelect"}})],1),e.addresseeSelect===e.ADDRESS_TO_RESTAURANTS?a("v-col",{staticClass:"area-select",attrs:{cols:"12",sm:"12"}},[a("v-autocomplete",{attrs:{outlined:"",label:"Select (a) Restaurant(s)",required:"","deletable-chips":"",multiple:"",chips:"",items:e.restaurantsList,"item-value":"id","item-text":"name",rules:e.restaurantSelectRules},on:{change:e.setRestaurantAsAddressee},model:{value:e.restaurantsSelected,callback:function(t){e.restaurantsSelected=t},expression:"restaurantsSelected"}})],1):e._e(),e.addresseeSelect===e.ADDRESS_TO_AREAS?a("v-col",{staticClass:"area-select",attrs:{cols:"12",sm:"12"}},[a("v-autocomplete",{attrs:{outlined:"",label:"Select (an) Area(s)",required:"","deletable-chips":"",multiple:"",chips:"",items:e.areasList,"item-value":"id","item-text":"name",rules:e.areaSelectRules},on:{change:e.setAreaAsAddressee},model:{value:e.areasSelected,callback:function(t){e.areasSelected=t},expression:"areasSelected"}})],1):e._e(),e.addresseeSelect===e.ADDRESS_TO_DRIVERS?a("v-col",{staticClass:"area-select",attrs:{cols:"12",sm:"12"}},[a("v-autocomplete",{attrs:{outlined:"",label:"Select (a) Driver(s)",required:"","deletable-chips":"",multiple:"",chips:"",items:e.driversList,"item-value":"id","item-text":"full_name",rules:e.driverSelectRules},on:{change:e.setDriverAsAddressee},model:{value:e.driversSelected,callback:function(t){e.driversSelected=t},expression:"driversSelected"}})],1):e._e(),a("v-col",{attrs:{cols:"12",sm:"12"}},[a("v-text-field",{attrs:{"clear-icon":"mdi-close",clearable:"",name:"Post Title",label:"Post Title*",outlined:"",rules:e.postTitleRules},model:{value:e.postTitle,callback:function(t){e.postTitle=t},expression:"postTitle"}})],1),a("v-col",{attrs:{cols:"12",sm:"12"}},[a("tiptap-vuetify",{attrs:{placeholder:"Post Content*",extensions:e.extensions},on:{keydown:e.postContentModifed},model:{value:e.postContent,callback:function(t){e.postContent=t},expression:"postContent"}}),this.postContentDirty&&!e.isPostContentValid?a("div",{staticClass:"v-messages theme--light error--text"},[e._v("\n                                        Please enter post content\n                                    ")]):e._e()],1),a("v-col",{attrs:{cols:"12",sm:"12"}},[a("v-file-input",{ref:"image",attrs:{rules:e.imgRules,accept:"image/png, image/jpeg, image/jpg, image/bmp",placeholder:"Upload a file","prepend-icon":"mdi-camera",label:"File"},on:{change:e.onChangeFileUpload}}),null!==this.postImg?a("v-img",{attrs:{"max-width":"500px","max-height":"300px",src:e.appConfig.app_url+"/images/"+this.postImg},model:{value:e.postImg,callback:function(t){e.postImg=t},expression:"postImg"}}):e._e()],1),a("v-col",{attrs:{cols:"12",sm:"12"}},[a("v-checkbox",{attrs:{"true-value":e.IMPORTANT_YES,"false-value":e.IMPORTANT_DEFAULT,label:"Important"},model:{value:e.checkbox,callback:function(t){e.checkbox=t},expression:"checkbox"}})],1)],1)],1),a("div",{staticClass:"d-flex justify-center"},[a("v-btn",{staticClass:"mr-4",attrs:{color:"primary",depressed:"",disabled:!e.valid||e.localLoading||!e.isPostContentValid,loading:e.localLoading},on:{click:e.submit}},[a("v-icon",{attrs:{left:""}},[e._v("mdi-check-box-outline")]),e._v("\n                                Accept Changes\n                            ")],1),a("v-btn",{attrs:{color:"warning",depressed:"",loading:e.localLoading},on:{click:e.cancel}},[a("v-icon",{attrs:{left:""}},[e._v("mdi-cancel")]),e._v("Cancel")],1)],1)],1)],1)],1)],1)],1)],1)}),[],!1,null,"57f7131b",null);t.a=A.exports;d()(A,{VAutocomplete:p.a,VBtn:v.a,VCard:u.a,VCardText:m.b,VCardTitle:m.c,VCheckbox:h.a,VCol:g.a,VContainer:f.a,VDialog:b.a,VFileInput:S.a,VFlex:x.a,VForm:k.a,VIcon:y.a,VImg:C.a,VLayout:D.a,VSelect:w.a,VTextField:T.a,VTooltip:R.a})},c7ca:function(e,t,a){},dcac:function(e,t,a){},e78d:function(e,t,a){"use strict";a("c7ca")},e889:function(e,t,a){"use strict";var s=a("2b0e"),i=a("2f62"),n=a("2ef0"),o=a("3f38"),l=a("55c2");var r={components:{TiptapVuetify:o.c},name:"NewPostModal",props:["restaurantId","postsList"],data:()=>({checkbox:l.a,file:{},dialog:!1,messageAll:!1,ADDRESS_TO_ALL:10,ADDRESS_TO_AREAS:20,ADDRESS_TO_RESTAURANTS:30,ADDRESS_TO_DRIVERS:40,postTitle:"",postContent:"",postContentDirty:!1,addresseeSelect:10,addresseeList:[{id:10,value:"All"},{id:20,value:"Selected Areas"},{id:30,value:"Selected Restaurants"},{id:40,value:"Selected Driver(s)"}],areasSelected:[],restaurantsSelected:[],driversSelected:[],valid:!1,localLoading:!1,postTitleRules:[e=>!!e||"Please enter post title"],postContentRules:[e=>!!e||"Please enter post content"],restaurantSelectRules:[e=>!!e||"Please select a restaurant"],areaSelectRules:[e=>!!e||"Please select an area"],driverSelectRules:[e=>!!e||"Please select (a) driver(s)"],imgRules:[e=>!(e&&e.size>1e7)||"File size should be less than 10 MB!"],extensions:[o.e,o.b,o.a],IMPORTANT_YES:l.b,IMPORTANT_DEFAULT:l.a}),created(){this.restaurantId&&(this.addresseeSelect=30,this.restaurantsSelected=[+this.restaurantId],this.messageAll=!0)},computed:{...Object(i.c)(["restaurants","areas","drivers"]),areasList(){return this.areas},restaurantsList(){return this.restaurants},driversList(){return this.drivers},isPostContentValid(){return!!this.postContent&&"<p></p>"!=this.postContent}},methods:{onChangeFileUpload(e){this.file=e},resetAddresseeData(){this.areasSelected=[],this.restaurantsSelected=[],this.driversSelected=[]},setAreaAsAddressee(){},setRestaurantAsAddressee(){},setDriverAsAddressee(){},postContentModifed(){s.a.nextTick(()=>{"<p></p>"==this.postContent&&(this.postContent="")}),this.postContentDirty=!0},submit(){if(this.$refs.form.validate()){this.localLoading=!0;let e=new FormData;e.append("file",this.file),e.append("postTitle",this.postTitle),e.append("postContent",this.postContent),n.isEmpty(this.areasSelected)||e.append("areas",JSON.stringify(this.areasSelected)),n.isEmpty(this.restaurantsSelected)||e.append("restaurants",JSON.stringify(this.restaurantsSelected)),n.isEmpty(this.driversSelected)||e.append("drivers",JSON.stringify(this.driversSelected)),e.append("important",this.checkbox),this.$store.dispatch("createNewPost",e).then(()=>{this.dialog=!1,this.clear()}).finally(()=>{this.localLoading=!1})}},clear(){this.checkbox=!1,this.addresseeSelect=10,this.areasSelected=[],this.restaurantsSelected=[],this.driversSelected=[],this.postTitle="",this.postContent="",this.postContentDirty=!1,this.file={},this.$refs.form.reset()}}},c=(a("e78d"),a("2877")),d=a("6544"),p=a.n(d),v=a("c6a6"),u=a("8336"),_=a("b0af"),m=a("99d9"),h=a("ac7c"),g=a("62ad"),f=a("a523"),b=a("169a"),S=a("23a7"),x=a("0e8f"),k=a("4bd4"),y=a("132d"),C=a("a722"),D=a("da13"),w=a("5d23"),T=a("b974"),R=a("8654"),A=Object(c.a)(r,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.messageAll?a("v-list-item",{on:{click:function(t){t.stopPropagation(),e.dialog=!0}}},[a("v-list-item-title",[e._v("Message All")])],1):a("v-btn",{staticClass:"primary",attrs:{depressed:""},on:{click:function(t){t.stopPropagation(),e.dialog=!0}}},[a("v-icon",{attrs:{left:""}},[e._v("mdi-post")]),e._v("\n        Publish a New Post\n    ")],1),a("v-dialog",{attrs:{width:"600px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e._v("Publish a New Post")]),a("div",{staticClass:"dialog-closeBtn",on:{click:function(t){e.dialog=!1}}},[a("v-icon",{attrs:{left:""}},[e._v("mdi-close")])],1)]),a("v-card-text",[a("v-container",{staticClass:"pl-0 pr-0"},[a("v-form",{ref:"form",attrs:{validation:""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-col",{staticClass:"area-select",attrs:{cols:"12",sm:"12"}},[a("v-select",{attrs:{outlined:"",label:"To*",required:"",readonly:e.messageAll,disabled:e.messageAll,items:e.addresseeList,"item-value":"id","item-text":"value"},on:{change:e.resetAddresseeData},model:{value:e.addresseeSelect,callback:function(t){e.addresseeSelect=t},expression:"addresseeSelect"}})],1),e.addresseeSelect===e.ADDRESS_TO_RESTAURANTS?a("v-col",{staticClass:"area-select",attrs:{cols:"12",sm:"12"}},[a("v-autocomplete",{attrs:{outlined:"",label:"Select (a) Restaurant(s)",required:"","deletable-chips":"",multiple:"",chips:"",readonly:e.messageAll,disabled:e.messageAll,items:e.restaurantsList,"item-value":"id","item-text":"name",rules:e.restaurantSelectRules},on:{change:e.setRestaurantAsAddressee},model:{value:e.restaurantsSelected,callback:function(t){e.restaurantsSelected=t},expression:"restaurantsSelected"}})],1):e._e(),e.addresseeSelect===e.ADDRESS_TO_AREAS?a("v-col",{staticClass:"area-select",attrs:{cols:"12",sm:"12"}},[a("v-autocomplete",{attrs:{outlined:"",label:"Select (an) Area(s)",required:"","deletable-chips":"",multiple:"",chips:"",items:e.areasList,"item-value":"id","item-text":"name",rules:e.areaSelectRules},on:{change:e.setAreaAsAddressee},model:{value:e.areasSelected,callback:function(t){e.areasSelected=t},expression:"areasSelected"}})],1):e._e(),e.addresseeSelect===e.ADDRESS_TO_DRIVERS?a("v-col",{staticClass:"area-select",attrs:{cols:"12",sm:"12"}},[a("v-autocomplete",{attrs:{outlined:"",label:"Select (a) Driver(s)",required:"","deletable-chips":"",multiple:"",chips:"",items:e.driversList,"item-value":"id","item-text":"full_name",rules:e.driverSelectRules},on:{change:e.setDriverAsAddressee},model:{value:e.driversSelected,callback:function(t){e.driversSelected=t},expression:"driversSelected"}})],1):e._e(),a("v-col",{attrs:{cols:"12",sm:"12"}},[a("v-text-field",{attrs:{"clear-icon":"mdi-close",clearable:"",name:"Post Title",label:"Post Title*",outlined:"",rules:e.postTitleRules},model:{value:e.postTitle,callback:function(t){e.postTitle=t},expression:"postTitle"}})],1),a("v-col",{attrs:{cols:"12",sm:"12"}},[a("tiptap-vuetify",{attrs:{placeholder:"Post Content*",extensions:e.extensions},on:{keydown:e.postContentModifed},model:{value:e.postContent,callback:function(t){e.postContent=t},expression:"postContent"}}),this.postContentDirty&&!e.isPostContentValid?a("div",{staticClass:"v-messages theme--light error--text"},[e._v("\n                                        Please enter post content\n                                    ")]):e._e()],1),a("v-col",{attrs:{cols:"12",sm:"12"}},[a("v-file-input",{ref:"image",attrs:{rules:e.imgRules,accept:"image/png, image/jpeg, image/jpg, image/bmp",placeholder:"Upload a file","prepend-icon":"mdi-camera",label:"File"},on:{change:e.onChangeFileUpload}})],1),a("v-col",{attrs:{cols:"12",sm:"12"}},[a("v-checkbox",{attrs:{"true-value":e.IMPORTANT_YES,"false-value":e.IMPORTANT_DEFAULT,label:"Important"},model:{value:e.checkbox,callback:function(t){e.checkbox=t},expression:"checkbox"}})],1)],1)],1),a("div",{staticClass:"d-flex justify-center"},[a("v-btn",{staticClass:"mr-4",attrs:{color:"primary",depressed:"",disabled:!e.valid||e.localLoading||!e.isPostContentValid,loading:e.localLoading},on:{click:e.submit}},[a("v-icon",{attrs:{left:""}},[e._v("mdi-publish")]),e._v("Publish")],1),a("v-btn",{attrs:{color:"warning",depressed:"",loading:e.localLoading},on:{click:e.clear}},[a("v-icon",{attrs:{left:""}},[e._v("mdi-cancel")]),e._v("Clear")],1)],1)],1)],1)],1)],1)],1)],1)}),[],!1,null,"2738b45c",null);t.a=A.exports;p()(A,{VAutocomplete:v.a,VBtn:u.a,VCard:_.a,VCardText:m.b,VCardTitle:m.c,VCheckbox:h.a,VCol:g.a,VContainer:f.a,VDialog:b.a,VFileInput:S.a,VFlex:x.a,VForm:k.a,VIcon:y.a,VLayout:C.a,VListItem:D.a,VListItemTitle:w.c,VSelect:T.a,VTextField:R.a})},eaf2:function(e,t,a){"use strict";a("65cf")},ec97:function(e,t,a){},ef72:function(e,t,a){"use strict";a("ec97")}}]);